(function(){const B=document.createElement("link").relList;if(B&&B.supports&&B.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))E(f);new MutationObserver(f=>{for(const e of f)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&E(l)}).observe(document,{childList:!0,subtree:!0});function P(f){const e={};return f.integrity&&(e.integrity=f.integrity),f.referrerPolicy&&(e.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?e.credentials="include":f.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function E(f){if(f.ep)return;f.ep=!0;const e=P(f);fetch(f.href,e)}})();var ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ue(D){return D&&D.__esModule&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D}var se={exports:{}};/*!
 * matter-js 0.20.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var We=se.exports,Se;function $e(){return Se||(Se=1,(function(D,B){(function(E,f){D.exports=f()})(We,function(){return(function(P){var E={};function f(e){if(E[e])return E[e].exports;var l=E[e]={i:e,l:!1,exports:{}};return P[e].call(l.exports,l,l.exports,f),l.l=!0,l.exports}return f.m=P,f.c=E,f.d=function(e,l,s){f.o(e,l)||Object.defineProperty(e,l,{enumerable:!0,get:s})},f.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.t=function(e,l){if(l&1&&(e=f(e)),l&8||l&4&&typeof e=="object"&&e&&e.__esModule)return e;var s=Object.create(null);if(f.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),l&2&&typeof e!="string")for(var o in e)f.d(s,o,(function(u){return e[u]}).bind(null,o));return s},f.n=function(e){var l=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(l,"a",l),l},f.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)},f.p="",f(f.s=20)})([(function(P,E){var f={};P.exports=f,(function(){f._baseDelta=1e3/60,f._nextId=0,f._seed=0,f._nowStartTime=+new Date,f._warnedOnce={},f._decomp=null,f.extend=function(l,s){var o,u;typeof s=="boolean"?(o=2,u=s):(o=1,u=!0);for(var n=o;n<arguments.length;n++){var v=arguments[n];if(v)for(var r in v)u&&v[r]&&v[r].constructor===Object&&(!l[r]||l[r].constructor===Object)?(l[r]=l[r]||{},f.extend(l[r],u,v[r])):l[r]=v[r]}return l},f.clone=function(l,s){return f.extend({},s,l)},f.keys=function(l){if(Object.keys)return Object.keys(l);var s=[];for(var o in l)s.push(o);return s},f.values=function(l){var s=[];if(Object.keys){for(var o=Object.keys(l),u=0;u<o.length;u++)s.push(l[o[u]]);return s}for(var n in l)s.push(l[n]);return s},f.get=function(l,s,o,u){s=s.split(".").slice(o,u);for(var n=0;n<s.length;n+=1)l=l[s[n]];return l},f.set=function(l,s,o,u,n){var v=s.split(".").slice(u,n);return f.get(l,s,0,-1)[v[v.length-1]]=o,o},f.shuffle=function(l){for(var s=l.length-1;s>0;s--){var o=Math.floor(f.random()*(s+1)),u=l[s];l[s]=l[o],l[o]=u}return l},f.choose=function(l){return l[Math.floor(f.random()*l.length)]},f.isElement=function(l){return typeof HTMLElement<"u"?l instanceof HTMLElement:!!(l&&l.nodeType&&l.nodeName)},f.isArray=function(l){return Object.prototype.toString.call(l)==="[object Array]"},f.isFunction=function(l){return typeof l=="function"},f.isPlainObject=function(l){return typeof l=="object"&&l.constructor===Object},f.isString=function(l){return toString.call(l)==="[object String]"},f.clamp=function(l,s,o){return l<s?s:l>o?o:l},f.sign=function(l){return l<0?-1:1},f.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-f._nowStartTime},f.random=function(l,s){return l=typeof l<"u"?l:0,s=typeof s<"u"?s:1,l+e()*(s-l)};var e=function(){return f._seed=(f._seed*9301+49297)%233280,f._seed/233280};f.colorToNumber=function(l){return l=l.replace("#",""),l.length==3&&(l=l.charAt(0)+l.charAt(0)+l.charAt(1)+l.charAt(1)+l.charAt(2)+l.charAt(2)),parseInt(l,16)},f.logLevel=1,f.log=function(){console&&f.logLevel>0&&f.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.info=function(){console&&f.logLevel>0&&f.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.warn=function(){console&&f.logLevel>0&&f.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.warnOnce=function(){var l=Array.prototype.slice.call(arguments).join(" ");f._warnedOnce[l]||(f.warn(l),f._warnedOnce[l]=!0)},f.deprecated=function(l,s,o){l[s]=f.chain(function(){f.warnOnce("ðŸ”… deprecated ðŸ”…",o)},l[s])},f.nextId=function(){return f._nextId++},f.indexOf=function(l,s){if(l.indexOf)return l.indexOf(s);for(var o=0;o<l.length;o++)if(l[o]===s)return o;return-1},f.map=function(l,s){if(l.map)return l.map(s);for(var o=[],u=0;u<l.length;u+=1)o.push(s(l[u]));return o},f.topologicalSort=function(l){var s=[],o=[],u=[];for(var n in l)!o[n]&&!u[n]&&f._topologicalSort(n,o,u,l,s);return s},f._topologicalSort=function(l,s,o,u,n){var v=u[l]||[];o[l]=!0;for(var r=0;r<v.length;r+=1){var t=v[r];o[t]||s[t]||f._topologicalSort(t,s,o,u,n)}o[l]=!1,s[l]=!0,n.push(l)},f.chain=function(){for(var l=[],s=0;s<arguments.length;s+=1){var o=arguments[s];o._chained?l.push.apply(l,o._chained):l.push(o)}var u=function(){for(var n,v=new Array(arguments.length),r=0,t=arguments.length;r<t;r++)v[r]=arguments[r];for(r=0;r<l.length;r+=1){var a=l[r].apply(n,v);typeof a<"u"&&(n=a)}return n};return u._chained=l,u},f.chainPathBefore=function(l,s,o){return f.set(l,s,f.chain(o,f.get(l,s)))},f.chainPathAfter=function(l,s,o){return f.set(l,s,f.chain(f.get(l,s),o))},f.setDecomp=function(l){f._decomp=l},f.getDecomp=function(){var l=f._decomp;try{!l&&typeof window<"u"&&(l=window.decomp),!l&&typeof ye<"u"&&(l=ye.decomp)}catch{l=null}return l}})()}),(function(P,E){var f={};P.exports=f,(function(){f.create=function(e){var l={min:{x:0,y:0},max:{x:0,y:0}};return e&&f.update(l,e),l},f.update=function(e,l,s){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var o=0;o<l.length;o++){var u=l[o];u.x>e.max.x&&(e.max.x=u.x),u.x<e.min.x&&(e.min.x=u.x),u.y>e.max.y&&(e.max.y=u.y),u.y<e.min.y&&(e.min.y=u.y)}s&&(s.x>0?e.max.x+=s.x:e.min.x+=s.x,s.y>0?e.max.y+=s.y:e.min.y+=s.y)},f.contains=function(e,l){return l.x>=e.min.x&&l.x<=e.max.x&&l.y>=e.min.y&&l.y<=e.max.y},f.overlaps=function(e,l){return e.min.x<=l.max.x&&e.max.x>=l.min.x&&e.max.y>=l.min.y&&e.min.y<=l.max.y},f.translate=function(e,l){e.min.x+=l.x,e.max.x+=l.x,e.min.y+=l.y,e.max.y+=l.y},f.shift=function(e,l){var s=e.max.x-e.min.x,o=e.max.y-e.min.y;e.min.x=l.x,e.max.x=l.x+s,e.min.y=l.y,e.max.y=l.y+o}})()}),(function(P,E){var f={};P.exports=f,(function(){f.create=function(e,l){return{x:e||0,y:l||0}},f.clone=function(e){return{x:e.x,y:e.y}},f.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},f.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},f.rotate=function(e,l,s){var o=Math.cos(l),u=Math.sin(l);s||(s={});var n=e.x*o-e.y*u;return s.y=e.x*u+e.y*o,s.x=n,s},f.rotateAbout=function(e,l,s,o){var u=Math.cos(l),n=Math.sin(l);o||(o={});var v=s.x+((e.x-s.x)*u-(e.y-s.y)*n);return o.y=s.y+((e.x-s.x)*n+(e.y-s.y)*u),o.x=v,o},f.normalise=function(e){var l=f.magnitude(e);return l===0?{x:0,y:0}:{x:e.x/l,y:e.y/l}},f.dot=function(e,l){return e.x*l.x+e.y*l.y},f.cross=function(e,l){return e.x*l.y-e.y*l.x},f.cross3=function(e,l,s){return(l.x-e.x)*(s.y-e.y)-(l.y-e.y)*(s.x-e.x)},f.add=function(e,l,s){return s||(s={}),s.x=e.x+l.x,s.y=e.y+l.y,s},f.sub=function(e,l,s){return s||(s={}),s.x=e.x-l.x,s.y=e.y-l.y,s},f.mult=function(e,l){return{x:e.x*l,y:e.y*l}},f.div=function(e,l){return{x:e.x/l,y:e.y/l}},f.perp=function(e,l){return l=l===!0?-1:1,{x:l*-e.y,y:l*e.x}},f.neg=function(e){return{x:-e.x,y:-e.y}},f.angle=function(e,l){return Math.atan2(l.y-e.y,l.x-e.x)},f._temp=[f.create(),f.create(),f.create(),f.create(),f.create(),f.create()]})()}),(function(P,E,f){var e={};P.exports=e;var l=f(2),s=f(0);(function(){e.create=function(o,u){for(var n=[],v=0;v<o.length;v++){var r=o[v],t={x:r.x,y:r.y,index:v,body:u,isInternal:!1};n.push(t)}return n},e.fromPath=function(o,u){var n=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,v=[];return o.replace(n,function(r,t,a){v.push({x:parseFloat(t),y:parseFloat(a)})}),e.create(v,u)},e.centre=function(o){for(var u=e.area(o,!0),n={x:0,y:0},v,r,t,a=0;a<o.length;a++)t=(a+1)%o.length,v=l.cross(o[a],o[t]),r=l.mult(l.add(o[a],o[t]),v),n=l.add(n,r);return l.div(n,6*u)},e.mean=function(o){for(var u={x:0,y:0},n=0;n<o.length;n++)u.x+=o[n].x,u.y+=o[n].y;return l.div(u,o.length)},e.area=function(o,u){for(var n=0,v=o.length-1,r=0;r<o.length;r++)n+=(o[v].x-o[r].x)*(o[v].y+o[r].y),v=r;return u?n/2:Math.abs(n)/2},e.inertia=function(o,u){for(var n=0,v=0,r=o,t,a,i=0;i<r.length;i++)a=(i+1)%r.length,t=Math.abs(l.cross(r[a],r[i])),n+=t*(l.dot(r[a],r[a])+l.dot(r[a],r[i])+l.dot(r[i],r[i])),v+=t;return u/6*(n/v)},e.translate=function(o,u,n){n=typeof n<"u"?n:1;var v=o.length,r=u.x*n,t=u.y*n,a;for(a=0;a<v;a++)o[a].x+=r,o[a].y+=t;return o},e.rotate=function(o,u,n){if(u!==0){var v=Math.cos(u),r=Math.sin(u),t=n.x,a=n.y,i=o.length,c,g,y,C;for(C=0;C<i;C++)c=o[C],g=c.x-t,y=c.y-a,c.x=t+(g*v-y*r),c.y=a+(g*r+y*v);return o}},e.contains=function(o,u){for(var n=u.x,v=u.y,r=o.length,t=o[r-1],a,i=0;i<r;i++){if(a=o[i],(n-t.x)*(a.y-t.y)+(v-t.y)*(t.x-a.x)>0)return!1;t=a}return!0},e.scale=function(o,u,n,v){if(u===1&&n===1)return o;v=v||e.centre(o);for(var r,t,a=0;a<o.length;a++)r=o[a],t=l.sub(r,v),o[a].x=v.x+t.x*u,o[a].y=v.y+t.y*n;return o},e.chamfer=function(o,u,n,v,r){typeof u=="number"?u=[u]:u=u||[8],n=typeof n<"u"?n:-1,v=v||2,r=r||14;for(var t=[],a=0;a<o.length;a++){var i=o[a-1>=0?a-1:o.length-1],c=o[a],g=o[(a+1)%o.length],y=u[a<u.length?a:u.length-1];if(y===0){t.push(c);continue}var C=l.normalise({x:c.y-i.y,y:i.x-c.x}),T=l.normalise({x:g.y-c.y,y:c.x-g.x}),m=Math.sqrt(2*Math.pow(y,2)),p=l.mult(s.clone(C),y),d=l.normalise(l.mult(l.add(C,T),.5)),h=l.sub(c,l.mult(d,m)),S=n;n===-1&&(S=Math.pow(y,.32)*1.75),S=s.clamp(S,v,r),S%2===1&&(S+=1);for(var x=Math.acos(l.dot(C,T)),w=x/S,M=0;M<S;M++)t.push(l.add(l.rotate(p,w*M),h))}return t},e.clockwiseSort=function(o){var u=e.mean(o);return o.sort(function(n,v){return l.angle(u,n)-l.angle(u,v)}),o},e.isConvex=function(o){var u=0,n=o.length,v,r,t,a;if(n<3)return null;for(v=0;v<n;v++)if(r=(v+1)%n,t=(v+2)%n,a=(o[r].x-o[v].x)*(o[t].y-o[r].y),a-=(o[r].y-o[v].y)*(o[t].x-o[r].x),a<0?u|=1:a>0&&(u|=2),u===3)return!1;return u!==0?!0:null},e.hull=function(o){var u=[],n=[],v,r;for(o=o.slice(0),o.sort(function(t,a){var i=t.x-a.x;return i!==0?i:t.y-a.y}),r=0;r<o.length;r+=1){for(v=o[r];n.length>=2&&l.cross3(n[n.length-2],n[n.length-1],v)<=0;)n.pop();n.push(v)}for(r=o.length-1;r>=0;r-=1){for(v=o[r];u.length>=2&&l.cross3(u[u.length-2],u[u.length-1],v)<=0;)u.pop();u.push(v)}return u.pop(),n.pop(),u.concat(n)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(3),s=f(2),o=f(7),u=f(0),n=f(1),v=f(11);(function(){e._timeCorrection=!0,e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e._baseDelta=1e3/60,e.create=function(t){var a={id:u.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:l.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},i=u.extend(a,t);return r(i,t),i},e.nextGroup=function(t){return t?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var r=function(t,a){a=a||{},e.set(t,{bounds:t.bounds||n.create(t.vertices),positionPrev:t.positionPrev||s.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),l.rotate(t.vertices,t.angle,t.position),v.rotate(t.axes,t.angle),n.update(t.bounds,t.vertices,t.velocity),e.set(t,{axes:a.axes||t.axes,area:a.area||t.area,mass:a.mass||t.mass,inertia:a.inertia||t.inertia});var i=t.isStatic?"#14151f":u.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),c=t.isStatic?"#555":"#ccc",g=t.isStatic&&t.render.fillStyle===null?1:0;t.render.fillStyle=t.render.fillStyle||i,t.render.strokeStyle=t.render.strokeStyle||c,t.render.lineWidth=t.render.lineWidth||g,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};e.set=function(t,a,i){var c;typeof a=="string"&&(c=a,a={},a[c]=i);for(c in a)if(Object.prototype.hasOwnProperty.call(a,c))switch(i=a[c],c){case"isStatic":e.setStatic(t,i);break;case"isSleeping":o.set(t,i);break;case"mass":e.setMass(t,i);break;case"density":e.setDensity(t,i);break;case"inertia":e.setInertia(t,i);break;case"vertices":e.setVertices(t,i);break;case"position":e.setPosition(t,i);break;case"angle":e.setAngle(t,i);break;case"velocity":e.setVelocity(t,i);break;case"angularVelocity":e.setAngularVelocity(t,i);break;case"speed":e.setSpeed(t,i);break;case"angularSpeed":e.setAngularSpeed(t,i);break;case"parts":e.setParts(t,i);break;case"centre":e.setCentre(t,i);break;default:t[c]=i}},e.setStatic=function(t,a){for(var i=0;i<t.parts.length;i++){var c=t.parts[i];a?(c.isStatic||(c._original={restitution:c.restitution,friction:c.friction,mass:c.mass,inertia:c.inertia,density:c.density,inverseMass:c.inverseMass,inverseInertia:c.inverseInertia}),c.restitution=0,c.friction=1,c.mass=c.inertia=c.density=1/0,c.inverseMass=c.inverseInertia=0,c.positionPrev.x=c.position.x,c.positionPrev.y=c.position.y,c.anglePrev=c.angle,c.angularVelocity=0,c.speed=0,c.angularSpeed=0,c.motion=0):c._original&&(c.restitution=c._original.restitution,c.friction=c._original.friction,c.mass=c._original.mass,c.inertia=c._original.inertia,c.density=c._original.density,c.inverseMass=c._original.inverseMass,c.inverseInertia=c._original.inverseInertia,c._original=null),c.isStatic=a}},e.setMass=function(t,a){var i=t.inertia/(t.mass/6);t.inertia=i*(a/6),t.inverseInertia=1/t.inertia,t.mass=a,t.inverseMass=1/t.mass,t.density=t.mass/t.area},e.setDensity=function(t,a){e.setMass(t,a*t.area),t.density=a},e.setInertia=function(t,a){t.inertia=a,t.inverseInertia=1/t.inertia},e.setVertices=function(t,a){a[0].body===t?t.vertices=a:t.vertices=l.create(a,t),t.axes=v.fromVertices(t.vertices),t.area=l.area(t.vertices),e.setMass(t,t.density*t.area);var i=l.centre(t.vertices);l.translate(t.vertices,i,-1),e.setInertia(t,e._inertiaScale*l.inertia(t.vertices,t.mass)),l.translate(t.vertices,t.position),n.update(t.bounds,t.vertices,t.velocity)},e.setParts=function(t,a,i){var c;for(a=a.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,c=0;c<a.length;c++){var g=a[c];g!==t&&(g.parent=t,t.parts.push(g))}if(t.parts.length!==1){if(i=typeof i<"u"?i:!0,i){var y=[];for(c=0;c<a.length;c++)y=y.concat(a[c].vertices);l.clockwiseSort(y);var C=l.hull(y),T=l.centre(C);e.setVertices(t,C),l.translate(t.vertices,T)}var m=e._totalProperties(t);t.area=m.area,t.parent=t,t.position.x=m.centre.x,t.position.y=m.centre.y,t.positionPrev.x=m.centre.x,t.positionPrev.y=m.centre.y,e.setMass(t,m.mass),e.setInertia(t,m.inertia),e.setPosition(t,m.centre)}},e.setCentre=function(t,a,i){i?(t.positionPrev.x+=a.x,t.positionPrev.y+=a.y,t.position.x+=a.x,t.position.y+=a.y):(t.positionPrev.x=a.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=a.y-(t.position.y-t.positionPrev.y),t.position.x=a.x,t.position.y=a.y)},e.setPosition=function(t,a,i){var c=s.sub(a,t.position);i?(t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.velocity.x=c.x,t.velocity.y=c.y,t.speed=s.magnitude(c)):(t.positionPrev.x+=c.x,t.positionPrev.y+=c.y);for(var g=0;g<t.parts.length;g++){var y=t.parts[g];y.position.x+=c.x,y.position.y+=c.y,l.translate(y.vertices,c),n.update(y.bounds,y.vertices,t.velocity)}},e.setAngle=function(t,a,i){var c=a-t.angle;i?(t.anglePrev=t.angle,t.angularVelocity=c,t.angularSpeed=Math.abs(c)):t.anglePrev+=c;for(var g=0;g<t.parts.length;g++){var y=t.parts[g];y.angle+=c,l.rotate(y.vertices,c,t.position),v.rotate(y.axes,c),n.update(y.bounds,y.vertices,t.velocity),g>0&&s.rotateAbout(y.position,c,t.position,y.position)}},e.setVelocity=function(t,a){var i=t.deltaTime/e._baseDelta;t.positionPrev.x=t.position.x-a.x*i,t.positionPrev.y=t.position.y-a.y*i,t.velocity.x=(t.position.x-t.positionPrev.x)/i,t.velocity.y=(t.position.y-t.positionPrev.y)/i,t.speed=s.magnitude(t.velocity)},e.getVelocity=function(t){var a=e._baseDelta/t.deltaTime;return{x:(t.position.x-t.positionPrev.x)*a,y:(t.position.y-t.positionPrev.y)*a}},e.getSpeed=function(t){return s.magnitude(e.getVelocity(t))},e.setSpeed=function(t,a){e.setVelocity(t,s.mult(s.normalise(e.getVelocity(t)),a))},e.setAngularVelocity=function(t,a){var i=t.deltaTime/e._baseDelta;t.anglePrev=t.angle-a*i,t.angularVelocity=(t.angle-t.anglePrev)/i,t.angularSpeed=Math.abs(t.angularVelocity)},e.getAngularVelocity=function(t){return(t.angle-t.anglePrev)*e._baseDelta/t.deltaTime},e.getAngularSpeed=function(t){return Math.abs(e.getAngularVelocity(t))},e.setAngularSpeed=function(t,a){e.setAngularVelocity(t,u.sign(e.getAngularVelocity(t))*a)},e.translate=function(t,a,i){e.setPosition(t,s.add(t.position,a),i)},e.rotate=function(t,a,i,c){if(!i)e.setAngle(t,t.angle+a,c);else{var g=Math.cos(a),y=Math.sin(a),C=t.position.x-i.x,T=t.position.y-i.y;e.setPosition(t,{x:i.x+(C*g-T*y),y:i.y+(C*y+T*g)},c),e.setAngle(t,t.angle+a,c)}},e.scale=function(t,a,i,c){var g=0,y=0;c=c||t.position;for(var C=0;C<t.parts.length;C++){var T=t.parts[C];l.scale(T.vertices,a,i,c),T.axes=v.fromVertices(T.vertices),T.area=l.area(T.vertices),e.setMass(T,t.density*T.area),l.translate(T.vertices,{x:-T.position.x,y:-T.position.y}),e.setInertia(T,e._inertiaScale*l.inertia(T.vertices,T.mass)),l.translate(T.vertices,{x:T.position.x,y:T.position.y}),C>0&&(g+=T.area,y+=T.inertia),T.position.x=c.x+(T.position.x-c.x)*a,T.position.y=c.y+(T.position.y-c.y)*i,n.update(T.bounds,T.vertices,t.velocity)}t.parts.length>1&&(t.area=g,t.isStatic||(e.setMass(t,t.density*g),e.setInertia(t,y))),t.circleRadius&&(a===i?t.circleRadius*=a:t.circleRadius=null)},e.update=function(t,a){a=(typeof a<"u"?a:1e3/60)*t.timeScale;var i=a*a,c=e._timeCorrection?a/(t.deltaTime||a):1,g=1-t.frictionAir*(a/u._baseDelta),y=(t.position.x-t.positionPrev.x)*c,C=(t.position.y-t.positionPrev.y)*c;t.velocity.x=y*g+t.force.x/t.mass*i,t.velocity.y=C*g+t.force.y/t.mass*i,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.deltaTime=a,t.angularVelocity=(t.angle-t.anglePrev)*g*c+t.torque/t.inertia*i,t.anglePrev=t.angle,t.angle+=t.angularVelocity;for(var T=0;T<t.parts.length;T++){var m=t.parts[T];l.translate(m.vertices,t.velocity),T>0&&(m.position.x+=t.velocity.x,m.position.y+=t.velocity.y),t.angularVelocity!==0&&(l.rotate(m.vertices,t.angularVelocity,t.position),v.rotate(m.axes,t.angularVelocity),T>0&&s.rotateAbout(m.position,t.angularVelocity,t.position,m.position)),n.update(m.bounds,m.vertices,t.velocity)}},e.updateVelocities=function(t){var a=e._baseDelta/t.deltaTime,i=t.velocity;i.x=(t.position.x-t.positionPrev.x)*a,i.y=(t.position.y-t.positionPrev.y)*a,t.speed=Math.sqrt(i.x*i.x+i.y*i.y),t.angularVelocity=(t.angle-t.anglePrev)*a,t.angularSpeed=Math.abs(t.angularVelocity)},e.applyForce=function(t,a,i){var c={x:a.x-t.position.x,y:a.y-t.position.y};t.force.x+=i.x,t.force.y+=i.y,t.torque+=c.x*i.y-c.y*i.x},e._totalProperties=function(t){for(var a={mass:0,area:0,inertia:0,centre:{x:0,y:0}},i=t.parts.length===1?0:1;i<t.parts.length;i++){var c=t.parts[i],g=c.mass!==1/0?c.mass:1;a.mass+=g,a.area+=c.area,a.inertia+=c.inertia,a.centre=s.add(a.centre,s.mult(c.position,g))}return a.centre=s.div(a.centre,a.mass),a}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(0);(function(){e.on=function(s,o,u){for(var n=o.split(" "),v,r=0;r<n.length;r++)v=n[r],s.events=s.events||{},s.events[v]=s.events[v]||[],s.events[v].push(u);return u},e.off=function(s,o,u){if(!o){s.events={};return}typeof o=="function"&&(u=o,o=l.keys(s.events).join(" "));for(var n=o.split(" "),v=0;v<n.length;v++){var r=s.events[n[v]],t=[];if(u&&r)for(var a=0;a<r.length;a++)r[a]!==u&&t.push(r[a]);s.events[n[v]]=t}},e.trigger=function(s,o,u){var n,v,r,t,a=s.events;if(a&&l.keys(a).length>0){u||(u={}),n=o.split(" ");for(var i=0;i<n.length;i++)if(v=n[i],r=a[v],r){t=l.clone(u,!1),t.name=v,t.source=s;for(var c=0;c<r.length;c++)r[c].apply(s,[t])}}}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(5),s=f(0),o=f(1),u=f(4);(function(){e.create=function(n){return s.extend({id:s.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},n)},e.setModified=function(n,v,r,t){if(n.isModified=v,v&&n.cache&&(n.cache.allBodies=null,n.cache.allConstraints=null,n.cache.allComposites=null),r&&n.parent&&e.setModified(n.parent,v,r,t),t)for(var a=0;a<n.composites.length;a++){var i=n.composites[a];e.setModified(i,v,r,t)}},e.add=function(n,v){var r=[].concat(v);l.trigger(n,"beforeAdd",{object:v});for(var t=0;t<r.length;t++){var a=r[t];switch(a.type){case"body":if(a.parent!==a){s.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(n,a);break;case"constraint":e.addConstraint(n,a);break;case"composite":e.addComposite(n,a);break;case"mouseConstraint":e.addConstraint(n,a.constraint);break}}return l.trigger(n,"afterAdd",{object:v}),n},e.remove=function(n,v,r){var t=[].concat(v);l.trigger(n,"beforeRemove",{object:v});for(var a=0;a<t.length;a++){var i=t[a];switch(i.type){case"body":e.removeBody(n,i,r);break;case"constraint":e.removeConstraint(n,i,r);break;case"composite":e.removeComposite(n,i,r);break;case"mouseConstraint":e.removeConstraint(n,i.constraint);break}}return l.trigger(n,"afterRemove",{object:v}),n},e.addComposite=function(n,v){return n.composites.push(v),v.parent=n,e.setModified(n,!0,!0,!1),n},e.removeComposite=function(n,v,r){var t=s.indexOf(n.composites,v);if(t!==-1){var a=e.allBodies(v);e.removeCompositeAt(n,t);for(var i=0;i<a.length;i++)a[i].sleepCounter=0}if(r)for(var i=0;i<n.composites.length;i++)e.removeComposite(n.composites[i],v,!0);return n},e.removeCompositeAt=function(n,v){return n.composites.splice(v,1),e.setModified(n,!0,!0,!1),n},e.addBody=function(n,v){return n.bodies.push(v),e.setModified(n,!0,!0,!1),n},e.removeBody=function(n,v,r){var t=s.indexOf(n.bodies,v);if(t!==-1&&(e.removeBodyAt(n,t),v.sleepCounter=0),r)for(var a=0;a<n.composites.length;a++)e.removeBody(n.composites[a],v,!0);return n},e.removeBodyAt=function(n,v){return n.bodies.splice(v,1),e.setModified(n,!0,!0,!1),n},e.addConstraint=function(n,v){return n.constraints.push(v),e.setModified(n,!0,!0,!1),n},e.removeConstraint=function(n,v,r){var t=s.indexOf(n.constraints,v);if(t!==-1&&e.removeConstraintAt(n,t),r)for(var a=0;a<n.composites.length;a++)e.removeConstraint(n.composites[a],v,!0);return n},e.removeConstraintAt=function(n,v){return n.constraints.splice(v,1),e.setModified(n,!0,!0,!1),n},e.clear=function(n,v,r){if(r)for(var t=0;t<n.composites.length;t++)e.clear(n.composites[t],v,!0);return v?n.bodies=n.bodies.filter(function(a){return a.isStatic}):n.bodies.length=0,n.constraints.length=0,n.composites.length=0,e.setModified(n,!0,!0,!1),n},e.allBodies=function(n){if(n.cache&&n.cache.allBodies)return n.cache.allBodies;for(var v=[].concat(n.bodies),r=0;r<n.composites.length;r++)v=v.concat(e.allBodies(n.composites[r]));return n.cache&&(n.cache.allBodies=v),v},e.allConstraints=function(n){if(n.cache&&n.cache.allConstraints)return n.cache.allConstraints;for(var v=[].concat(n.constraints),r=0;r<n.composites.length;r++)v=v.concat(e.allConstraints(n.composites[r]));return n.cache&&(n.cache.allConstraints=v),v},e.allComposites=function(n){if(n.cache&&n.cache.allComposites)return n.cache.allComposites;for(var v=[].concat(n.composites),r=0;r<n.composites.length;r++)v=v.concat(e.allComposites(n.composites[r]));return n.cache&&(n.cache.allComposites=v),v},e.get=function(n,v,r){var t,a;switch(r){case"body":t=e.allBodies(n);break;case"constraint":t=e.allConstraints(n);break;case"composite":t=e.allComposites(n).concat(n);break}return t?(a=t.filter(function(i){return i.id.toString()===v.toString()}),a.length===0?null:a[0]):null},e.move=function(n,v,r){return e.remove(n,v),e.add(r,v),n},e.rebase=function(n){for(var v=e.allBodies(n).concat(e.allConstraints(n)).concat(e.allComposites(n)),r=0;r<v.length;r++)v[r].id=s.nextId();return n},e.translate=function(n,v,r){for(var t=r?e.allBodies(n):n.bodies,a=0;a<t.length;a++)u.translate(t[a],v);return n},e.rotate=function(n,v,r,t){for(var a=Math.cos(v),i=Math.sin(v),c=t?e.allBodies(n):n.bodies,g=0;g<c.length;g++){var y=c[g],C=y.position.x-r.x,T=y.position.y-r.y;u.setPosition(y,{x:r.x+(C*a-T*i),y:r.y+(C*i+T*a)}),u.rotate(y,v)}return n},e.scale=function(n,v,r,t,a){for(var i=a?e.allBodies(n):n.bodies,c=0;c<i.length;c++){var g=i[c],y=g.position.x-t.x,C=g.position.y-t.y;u.setPosition(g,{x:t.x+y*v,y:t.y+C*r}),u.scale(g,v,r)}return n},e.bounds=function(n){for(var v=e.allBodies(n),r=[],t=0;t<v.length;t+=1){var a=v[t];r.push(a.bounds.min,a.bounds.max)}return o.create(r)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(4),s=f(5),o=f(0);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(u,n){for(var v=n/o._baseDelta,r=e._motionSleepThreshold,t=0;t<u.length;t++){var a=u[t],i=l.getSpeed(a),c=l.getAngularSpeed(a),g=i*i+c*c;if(a.force.x!==0||a.force.y!==0){e.set(a,!1);continue}var y=Math.min(a.motion,g),C=Math.max(a.motion,g);a.motion=e._minBias*y+(1-e._minBias)*C,a.sleepThreshold>0&&a.motion<r?(a.sleepCounter+=1,a.sleepCounter>=a.sleepThreshold/v&&e.set(a,!0)):a.sleepCounter>0&&(a.sleepCounter-=1)}},e.afterCollisions=function(u){for(var n=e._motionSleepThreshold,v=0;v<u.length;v++){var r=u[v];if(r.isActive){var t=r.collision,a=t.bodyA.parent,i=t.bodyB.parent;if(!(a.isSleeping&&i.isSleeping||a.isStatic||i.isStatic)&&(a.isSleeping||i.isSleeping)){var c=a.isSleeping&&!a.isStatic?a:i,g=c===a?i:a;!c.isStatic&&g.motion>n&&e.set(c,!1)}}}},e.set=function(u,n){var v=u.isSleeping;n?(u.isSleeping=!0,u.sleepCounter=u.sleepThreshold,u.positionImpulse.x=0,u.positionImpulse.y=0,u.positionPrev.x=u.position.x,u.positionPrev.y=u.position.y,u.anglePrev=u.angle,u.speed=0,u.angularSpeed=0,u.motion=0,v||s.trigger(u,"sleepStart")):(u.isSleeping=!1,u.sleepCounter=0,v&&s.trigger(u,"sleepEnd"))}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(3),s=f(9);(function(){var o=[],u={overlap:0,axis:null},n={overlap:0,axis:null};e.create=function(v,r){return{pair:null,collided:!1,bodyA:v,bodyB:r,parentA:v.parent,parentB:r.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},e.collides=function(v,r,t){if(e._overlapAxes(u,v.vertices,r.vertices,v.axes),u.overlap<=0||(e._overlapAxes(n,r.vertices,v.vertices,r.axes),n.overlap<=0))return null;var a=t&&t.table[s.id(v,r)],i;a?i=a.collision:(i=e.create(v,r),i.collided=!0,i.bodyA=v.id<r.id?v:r,i.bodyB=v.id<r.id?r:v,i.parentA=i.bodyA.parent,i.parentB=i.bodyB.parent),v=i.bodyA,r=i.bodyB;var c;u.overlap<n.overlap?c=u:c=n;var g=i.normal,y=i.tangent,C=i.penetration,T=i.supports,m=c.overlap,p=c.axis,d=p.x,h=p.y,S=r.position.x-v.position.x,x=r.position.y-v.position.y;d*S+h*x>=0&&(d=-d,h=-h),g.x=d,g.y=h,y.x=-h,y.y=d,C.x=d*m,C.y=h*m,i.depth=m;var w=e._findSupports(v,r,g,1),M=0;if(l.contains(v.vertices,w[0])&&(T[M++]=w[0]),l.contains(v.vertices,w[1])&&(T[M++]=w[1]),M<2){var A=e._findSupports(r,v,g,-1);l.contains(r.vertices,A[0])&&(T[M++]=A[0]),M<2&&l.contains(r.vertices,A[1])&&(T[M++]=A[1])}return M===0&&(T[M++]=w[0]),i.supportCount=M,i},e._overlapAxes=function(v,r,t,a){var i=r.length,c=t.length,g=r[0].x,y=r[0].y,C=t[0].x,T=t[0].y,m=a.length,p=Number.MAX_VALUE,d=0,h,S,x,w,M,A;for(M=0;M<m;M++){var F=a[M],R=F.x,k=F.y,L=g*R+y*k,O=C*R+T*k,V=L,U=O;for(A=1;A<i;A+=1)w=r[A].x*R+r[A].y*k,w>V?V=w:w<L&&(L=w);for(A=1;A<c;A+=1)w=t[A].x*R+t[A].y*k,w>U?U=w:w<O&&(O=w);if(S=V-O,x=U-L,h=S<x?S:x,h<p&&(p=h,d=M,h<=0))break}v.axis=a[d],v.overlap=p},e._findSupports=function(v,r,t,a){var i=r.vertices,c=i.length,g=v.position.x,y=v.position.y,C=t.x*a,T=t.y*a,m=i[0],p=m,d=C*(g-p.x)+T*(y-p.y),h,S,x;for(x=1;x<c;x+=1)p=i[x],S=C*(g-p.x)+T*(y-p.y),S<d&&(d=S,m=p);return h=i[(c+m.index-1)%c],d=C*(g-h.x)+T*(y-h.y),p=i[(m.index+1)%c],C*(g-p.x)+T*(y-p.y)<d?(o[0]=m,o[1]=p,o):(o[0]=m,o[1]=h,o)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(16);(function(){e.create=function(s,o){var u=s.bodyA,n=s.bodyB,v={id:e.id(u,n),bodyA:u,bodyB:n,collision:s,contacts:[l.create(),l.create()],contactCount:0,separation:0,isActive:!0,isSensor:u.isSensor||n.isSensor,timeCreated:o,timeUpdated:o,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(v,s,o),v},e.update=function(s,o,u){var n=o.supports,v=o.supportCount,r=s.contacts,t=o.parentA,a=o.parentB;s.isActive=!0,s.timeUpdated=u,s.collision=o,s.separation=o.depth,s.inverseMass=t.inverseMass+a.inverseMass,s.friction=t.friction<a.friction?t.friction:a.friction,s.frictionStatic=t.frictionStatic>a.frictionStatic?t.frictionStatic:a.frictionStatic,s.restitution=t.restitution>a.restitution?t.restitution:a.restitution,s.slop=t.slop>a.slop?t.slop:a.slop,s.contactCount=v,o.pair=s;var i=n[0],c=r[0],g=n[1],y=r[1];(y.vertex===i||c.vertex===g)&&(r[1]=c,r[0]=c=y,y=r[1]),c.vertex=i,y.vertex=g},e.setActive=function(s,o,u){o?(s.isActive=!0,s.timeUpdated=u):(s.isActive=!1,s.contactCount=0)},e.id=function(s,o){return s.id<o.id?s.id.toString(36)+":"+o.id.toString(36):o.id.toString(36)+":"+s.id.toString(36)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(3),s=f(2),o=f(7),u=f(1),n=f(11),v=f(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(r){var t=r;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var a=t.bodyA?s.add(t.bodyA.position,t.pointA):t.pointA,i=t.bodyB?s.add(t.bodyB.position,t.pointB):t.pointB,c=s.magnitude(s.sub(a,i));t.length=typeof t.length<"u"?t.length:c,t.id=t.id||v.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var g={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return t.length===0&&t.stiffness>.1?(g.type="pin",g.anchors=!1):t.stiffness<.9&&(g.type="spring"),t.render=v.extend(g,t.render),t},e.preSolveAll=function(r){for(var t=0;t<r.length;t+=1){var a=r[t],i=a.constraintImpulse;a.isStatic||i.x===0&&i.y===0&&i.angle===0||(a.position.x+=i.x,a.position.y+=i.y,a.angle+=i.angle)}},e.solveAll=function(r,t){for(var a=v.clamp(t/v._baseDelta,0,1),i=0;i<r.length;i+=1){var c=r[i],g=!c.bodyA||c.bodyA&&c.bodyA.isStatic,y=!c.bodyB||c.bodyB&&c.bodyB.isStatic;(g||y)&&e.solve(r[i],a)}for(i=0;i<r.length;i+=1)c=r[i],g=!c.bodyA||c.bodyA&&c.bodyA.isStatic,y=!c.bodyB||c.bodyB&&c.bodyB.isStatic,!g&&!y&&e.solve(r[i],a)},e.solve=function(r,t){var a=r.bodyA,i=r.bodyB,c=r.pointA,g=r.pointB;if(!(!a&&!i)){a&&!a.isStatic&&(s.rotate(c,a.angle-r.angleA,c),r.angleA=a.angle),i&&!i.isStatic&&(s.rotate(g,i.angle-r.angleB,g),r.angleB=i.angle);var y=c,C=g;if(a&&(y=s.add(a.position,c)),i&&(C=s.add(i.position,g)),!(!y||!C)){var T=s.sub(y,C),m=s.magnitude(T);m<e._minLength&&(m=e._minLength);var p=(m-r.length)/m,d=r.stiffness>=1||r.length===0,h=d?r.stiffness*t:r.stiffness*t*t,S=r.damping*t,x=s.mult(T,p*h),w=(a?a.inverseMass:0)+(i?i.inverseMass:0),M=(a?a.inverseInertia:0)+(i?i.inverseInertia:0),A=w+M,F,R,k,L,O;if(S>0){var V=s.create();k=s.div(T,m),O=s.sub(i&&s.sub(i.position,i.positionPrev)||V,a&&s.sub(a.position,a.positionPrev)||V),L=s.dot(k,O)}a&&!a.isStatic&&(R=a.inverseMass/w,a.constraintImpulse.x-=x.x*R,a.constraintImpulse.y-=x.y*R,a.position.x-=x.x*R,a.position.y-=x.y*R,S>0&&(a.positionPrev.x-=S*k.x*L*R,a.positionPrev.y-=S*k.y*L*R),F=s.cross(c,x)/A*e._torqueDampen*a.inverseInertia*(1-r.angularStiffness),a.constraintImpulse.angle-=F,a.angle-=F),i&&!i.isStatic&&(R=i.inverseMass/w,i.constraintImpulse.x+=x.x*R,i.constraintImpulse.y+=x.y*R,i.position.x+=x.x*R,i.position.y+=x.y*R,S>0&&(i.positionPrev.x+=S*k.x*L*R,i.positionPrev.y+=S*k.y*L*R),F=s.cross(g,x)/A*e._torqueDampen*i.inverseInertia*(1-r.angularStiffness),i.constraintImpulse.angle+=F,i.angle+=F)}}},e.postSolveAll=function(r){for(var t=0;t<r.length;t++){var a=r[t],i=a.constraintImpulse;if(!(a.isStatic||i.x===0&&i.y===0&&i.angle===0)){o.set(a,!1);for(var c=0;c<a.parts.length;c++){var g=a.parts[c];l.translate(g.vertices,i),c>0&&(g.position.x+=i.x,g.position.y+=i.y),i.angle!==0&&(l.rotate(g.vertices,i.angle,a.position),n.rotate(g.axes,i.angle),c>0&&s.rotateAbout(g.position,i.angle,a.position,g.position)),u.update(g.bounds,g.vertices,a.velocity)}i.angle*=e._warming,i.x*=e._warming,i.y*=e._warming}}},e.pointAWorld=function(r){return{x:(r.bodyA?r.bodyA.position.x:0)+(r.pointA?r.pointA.x:0),y:(r.bodyA?r.bodyA.position.y:0)+(r.pointA?r.pointA.y:0)}},e.pointBWorld=function(r){return{x:(r.bodyB?r.bodyB.position.x:0)+(r.pointB?r.pointB.x:0),y:(r.bodyB?r.bodyB.position.y:0)+(r.pointB?r.pointB.y:0)}},e.currentLength=function(r){var t=(r.bodyA?r.bodyA.position.x:0)+(r.pointA?r.pointA.x:0),a=(r.bodyA?r.bodyA.position.y:0)+(r.pointA?r.pointA.y:0),i=(r.bodyB?r.bodyB.position.x:0)+(r.pointB?r.pointB.x:0),c=(r.bodyB?r.bodyB.position.y:0)+(r.pointB?r.pointB.y:0),g=t-i,y=a-c;return Math.sqrt(g*g+y*y)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(2),s=f(0);(function(){e.fromVertices=function(o){for(var u={},n=0;n<o.length;n++){var v=(n+1)%o.length,r=l.normalise({x:o[v].y-o[n].y,y:o[n].x-o[v].x}),t=r.y===0?1/0:r.x/r.y;t=t.toFixed(3).toString(),u[t]=r}return s.values(u)},e.rotate=function(o,u){if(u!==0)for(var n=Math.cos(u),v=Math.sin(u),r=0;r<o.length;r++){var t=o[r],a;a=t.x*n-t.y*v,t.y=t.x*v+t.y*n,t.x=a}}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(3),s=f(0),o=f(4),u=f(1),n=f(2);(function(){e.rectangle=function(v,r,t,a,i){i=i||{};var c={label:"Rectangle Body",position:{x:v,y:r},vertices:l.fromPath("L 0 0 L "+t+" 0 L "+t+" "+a+" L 0 "+a)};if(i.chamfer){var g=i.chamfer;c.vertices=l.chamfer(c.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete i.chamfer}return o.create(s.extend({},c,i))},e.trapezoid=function(v,r,t,a,i,c){c=c||{},i>=1&&s.warn("Bodies.trapezoid: slope parameter must be < 1."),i*=.5;var g=(1-i*2)*t,y=t*i,C=y+g,T=C+y,m;i<.5?m="L 0 0 L "+y+" "+-a+" L "+C+" "+-a+" L "+T+" 0":m="L 0 0 L "+C+" "+-a+" L "+T+" 0";var p={label:"Trapezoid Body",position:{x:v,y:r},vertices:l.fromPath(m)};if(c.chamfer){var d=c.chamfer;p.vertices=l.chamfer(p.vertices,d.radius,d.quality,d.qualityMin,d.qualityMax),delete c.chamfer}return o.create(s.extend({},p,c))},e.circle=function(v,r,t,a,i){a=a||{};var c={label:"Circle Body",circleRadius:t};i=i||25;var g=Math.ceil(Math.max(10,Math.min(i,t)));return g%2===1&&(g+=1),e.polygon(v,r,g,t,s.extend({},c,a))},e.polygon=function(v,r,t,a,i){if(i=i||{},t<3)return e.circle(v,r,a,i);for(var c=2*Math.PI/t,g="",y=c*.5,C=0;C<t;C+=1){var T=y+C*c,m=Math.cos(T)*a,p=Math.sin(T)*a;g+="L "+m.toFixed(3)+" "+p.toFixed(3)+" "}var d={label:"Polygon Body",position:{x:v,y:r},vertices:l.fromPath(g)};if(i.chamfer){var h=i.chamfer;d.vertices=l.chamfer(d.vertices,h.radius,h.quality,h.qualityMin,h.qualityMax),delete i.chamfer}return o.create(s.extend({},d,i))},e.fromVertices=function(v,r,t,a,i,c,g,y){var C=s.getDecomp(),T,m,p,d,h,S,x,w,M,A,F;for(T=!!(C&&C.quickDecomp),a=a||{},p=[],i=typeof i<"u"?i:!1,c=typeof c<"u"?c:.01,g=typeof g<"u"?g:10,y=typeof y<"u"?y:.01,s.isArray(t[0])||(t=[t]),A=0;A<t.length;A+=1)if(S=t[A],d=l.isConvex(S),h=!d,h&&!T&&s.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),d||!T)d?S=l.clockwiseSort(S):S=l.hull(S),p.push({position:{x:v,y:r},vertices:S});else{var R=S.map(function(H){return[H.x,H.y]});C.makeCCW(R),c!==!1&&C.removeCollinearPoints(R,c),y!==!1&&C.removeDuplicatePoints&&C.removeDuplicatePoints(R,y);var k=C.quickDecomp(R);for(x=0;x<k.length;x++){var L=k[x],O=L.map(function(H){return{x:H[0],y:H[1]}});g>0&&l.area(O)<g||p.push({position:l.centre(O),vertices:O})}}for(x=0;x<p.length;x++)p[x]=o.create(s.extend(p[x],a));if(i){var V=5;for(x=0;x<p.length;x++){var U=p[x];for(w=x+1;w<p.length;w++){var W=p[w];if(u.overlaps(U.bounds,W.bounds)){var $=U.vertices,z=W.vertices;for(M=0;M<U.vertices.length;M++)for(F=0;F<W.vertices.length;F++){var J=n.magnitudeSquared(n.sub($[(M+1)%$.length],z[F])),b=n.magnitudeSquared(n.sub($[M],z[(F+1)%z.length]));J<V&&b<V&&($[M].isInternal=!0,z[F].isInternal=!0)}}}}}return p.length>1?(m=o.create(s.extend({parts:p.slice(0)},a)),o.setPosition(m,{x:v,y:r}),m):p[0]}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(0),s=f(8);(function(){e.create=function(o){var u={bodies:[],collisions:[],pairs:null};return l.extend(u,o)},e.setBodies=function(o,u){o.bodies=u.slice(0)},e.clear=function(o){o.bodies=[],o.collisions=[]},e.collisions=function(o){var u=o.pairs,n=o.bodies,v=n.length,r=e.canCollide,t=s.collides,a=o.collisions,i=0,c,g;for(n.sort(e._compareBoundsX),c=0;c<v;c++){var y=n[c],C=y.bounds,T=y.bounds.max.x,m=y.bounds.max.y,p=y.bounds.min.y,d=y.isStatic||y.isSleeping,h=y.parts.length,S=h===1;for(g=c+1;g<v;g++){var x=n[g],w=x.bounds;if(w.min.x>T)break;if(!(m<w.min.y||p>w.max.y)&&!(d&&(x.isStatic||x.isSleeping))&&r(y.collisionFilter,x.collisionFilter)){var M=x.parts.length;if(S&&M===1){var A=t(y,x,u);A&&(a[i++]=A)}else for(var F=h>1?1:0,R=M>1?1:0,k=F;k<h;k++)for(var L=y.parts[k],C=L.bounds,O=R;O<M;O++){var V=x.parts[O],w=V.bounds;if(!(C.min.x>w.max.x||C.max.x<w.min.x||C.max.y<w.min.y||C.min.y>w.max.y)){var A=t(L,V,u);A&&(a[i++]=A)}}}}}return a.length!==i&&(a.length=i),a},e.canCollide=function(o,u){return o.group===u.group&&o.group!==0?o.group>0:(o.mask&u.category)!==0&&(u.mask&o.category)!==0},e._compareBoundsX=function(o,u){return o.bounds.min.x-u.bounds.min.x}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(0);(function(){e.create=function(s){var o={};return s||l.log("Mouse.create: element was undefined, defaulting to document.body","warn"),o.element=s||document.body,o.absolute={x:0,y:0},o.position={x:0,y:0},o.mousedownPosition={x:0,y:0},o.mouseupPosition={x:0,y:0},o.offset={x:0,y:0},o.scale={x:1,y:1},o.wheelDelta=0,o.button=-1,o.pixelRatio=parseInt(o.element.getAttribute("data-pixel-ratio"),10)||1,o.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},o.mousemove=function(u){var n=e._getRelativeMousePosition(u,o.element,o.pixelRatio),v=u.changedTouches;v&&(o.button=0,u.preventDefault()),o.absolute.x=n.x,o.absolute.y=n.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.sourceEvents.mousemove=u},o.mousedown=function(u){var n=e._getRelativeMousePosition(u,o.element,o.pixelRatio),v=u.changedTouches;v?(o.button=0,u.preventDefault()):o.button=u.button,o.absolute.x=n.x,o.absolute.y=n.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.mousedownPosition.x=o.position.x,o.mousedownPosition.y=o.position.y,o.sourceEvents.mousedown=u},o.mouseup=function(u){var n=e._getRelativeMousePosition(u,o.element,o.pixelRatio),v=u.changedTouches;v&&u.preventDefault(),o.button=-1,o.absolute.x=n.x,o.absolute.y=n.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y,o.mouseupPosition.x=o.position.x,o.mouseupPosition.y=o.position.y,o.sourceEvents.mouseup=u},o.mousewheel=function(u){o.wheelDelta=Math.max(-1,Math.min(1,u.wheelDelta||-u.detail)),u.preventDefault(),o.sourceEvents.mousewheel=u},e.setElement(o,o.element),o},e.setElement=function(s,o){s.element=o,o.addEventListener("mousemove",s.mousemove,{passive:!0}),o.addEventListener("mousedown",s.mousedown,{passive:!0}),o.addEventListener("mouseup",s.mouseup,{passive:!0}),o.addEventListener("wheel",s.mousewheel,{passive:!1}),o.addEventListener("touchmove",s.mousemove,{passive:!1}),o.addEventListener("touchstart",s.mousedown,{passive:!1}),o.addEventListener("touchend",s.mouseup,{passive:!1})},e.clearSourceEvents=function(s){s.sourceEvents.mousemove=null,s.sourceEvents.mousedown=null,s.sourceEvents.mouseup=null,s.sourceEvents.mousewheel=null,s.wheelDelta=0},e.setOffset=function(s,o){s.offset.x=o.x,s.offset.y=o.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y},e.setScale=function(s,o){s.scale.x=o.x,s.scale.y=o.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y},e._getRelativeMousePosition=function(s,o,u){var n=o.getBoundingClientRect(),v=document.documentElement||document.body.parentNode||document.body,r=window.pageXOffset!==void 0?window.pageXOffset:v.scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:v.scrollTop,a=s.changedTouches,i,c;return a?(i=a[0].pageX-n.left-r,c=a[0].pageY-n.top-t):(i=s.pageX-n.left-r,c=s.pageY-n.top-t),{x:i/(o.clientWidth/(o.width||o.clientWidth)*u),y:c/(o.clientHeight/(o.height||o.clientHeight)*u)}}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(0);(function(){e._registry={},e.register=function(s){if(e.isPlugin(s)||l.warn("Plugin.register:",e.toString(s),"does not implement all required fields."),s.name in e._registry){var o=e._registry[s.name],u=e.versionParse(s.version).number,n=e.versionParse(o.version).number;u>n?(l.warn("Plugin.register:",e.toString(o),"was upgraded to",e.toString(s)),e._registry[s.name]=s):u<n?l.warn("Plugin.register:",e.toString(o),"can not be downgraded to",e.toString(s)):s!==o&&l.warn("Plugin.register:",e.toString(s),"is already registered to different plugin object")}else e._registry[s.name]=s;return s},e.resolve=function(s){return e._registry[e.dependencyParse(s).name]},e.toString=function(s){return typeof s=="string"?s:(s.name||"anonymous")+"@"+(s.version||s.range||"0.0.0")},e.isPlugin=function(s){return s&&s.name&&s.version&&s.install},e.isUsed=function(s,o){return s.used.indexOf(o)>-1},e.isFor=function(s,o){var u=s.for&&e.dependencyParse(s.for);return!s.for||o.name===u.name&&e.versionSatisfies(o.version,u.range)},e.use=function(s,o){if(s.uses=(s.uses||[]).concat(o||[]),s.uses.length===0){l.warn("Plugin.use:",e.toString(s),"does not specify any dependencies to install.");return}for(var u=e.dependencies(s),n=l.topologicalSort(u),v=[],r=0;r<n.length;r+=1)if(n[r]!==s.name){var t=e.resolve(n[r]);if(!t){v.push("âŒ "+n[r]);continue}e.isUsed(s,t.name)||(e.isFor(t,s)||(l.warn("Plugin.use:",e.toString(t),"is for",t.for,"but installed on",e.toString(s)+"."),t._warned=!0),t.install?t.install(s):(l.warn("Plugin.use:",e.toString(t),"does not specify an install function."),t._warned=!0),t._warned?(v.push("ðŸ”¶ "+e.toString(t)),delete t._warned):v.push("âœ… "+e.toString(t)),s.used.push(t.name))}v.length>0&&l.info(v.join("  "))},e.dependencies=function(s,o){var u=e.dependencyParse(s),n=u.name;if(o=o||{},!(n in o)){s=e.resolve(s)||s,o[n]=l.map(s.uses||[],function(r){e.isPlugin(r)&&e.register(r);var t=e.dependencyParse(r),a=e.resolve(r);return a&&!e.versionSatisfies(a.version,t.range)?(l.warn("Plugin.dependencies:",e.toString(a),"does not satisfy",e.toString(t),"used by",e.toString(u)+"."),a._warned=!0,s._warned=!0):a||(l.warn("Plugin.dependencies:",e.toString(r),"used by",e.toString(u),"could not be resolved."),s._warned=!0),t.name});for(var v=0;v<o[n].length;v+=1)e.dependencies(o[n][v],o);return o}},e.dependencyParse=function(s){if(l.isString(s)){var o=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return o.test(s)||l.warn("Plugin.dependencyParse:",s,"is not a valid dependency string."),{name:s.split("@")[0],range:s.split("@")[1]||"*"}}return{name:s.name,range:s.range||s.version}},e.versionParse=function(s){var o=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;o.test(s)||l.warn("Plugin.versionParse:",s,"is not a valid version or range.");var u=o.exec(s),n=Number(u[4]),v=Number(u[5]),r=Number(u[6]);return{isRange:!!(u[1]||u[2]),version:u[3],range:s,operator:u[1]||u[2]||"",major:n,minor:v,patch:r,parts:[n,v,r],prerelease:u[7],number:n*1e8+v*1e4+r}},e.versionSatisfies=function(s,o){o=o||"*";var u=e.versionParse(o),n=e.versionParse(s);if(u.isRange){if(u.operator==="*"||s==="*")return!0;if(u.operator===">")return n.number>u.number;if(u.operator===">=")return n.number>=u.number;if(u.operator==="~")return n.major===u.major&&n.minor===u.minor&&n.patch>=u.patch;if(u.operator==="^")return u.major>0?n.major===u.major&&n.number>=u.number:u.minor>0?n.minor===u.minor&&n.patch>=u.patch:n.patch===u.patch}return s===o||s==="*"}})()}),(function(P,E){var f={};P.exports=f,(function(){f.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(7),s=f(18),o=f(13),u=f(19),n=f(5),v=f(6),r=f(10),t=f(0),a=f(4);(function(){e._deltaMax=1e3/60,e.create=function(i){i=i||{};var c={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},g=t.extend(c,i);return g.world=i.world||v.create({label:"World"}),g.pairs=i.pairs||u.create(),g.detector=i.detector||o.create(),g.detector.pairs=g.pairs,g.grid={buckets:[]},g.world.gravity=g.gravity,g.broadphase=g.grid,g.metrics={},g},e.update=function(i,c){var g=t.now(),y=i.world,C=i.detector,T=i.pairs,m=i.timing,p=m.timestamp,d;c>e._deltaMax&&t.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",e._deltaMax.toFixed(3),"ms."),c=typeof c<"u"?c:t._baseDelta,c*=m.timeScale,m.timestamp+=c,m.lastDelta=c;var h={timestamp:m.timestamp,delta:c};n.trigger(i,"beforeUpdate",h);var S=v.allBodies(y),x=v.allConstraints(y);for(y.isModified&&(o.setBodies(C,S),v.setModified(y,!1,!1,!0)),i.enableSleeping&&l.update(S,c),e._bodiesApplyGravity(S,i.gravity),c>0&&e._bodiesUpdate(S,c),n.trigger(i,"beforeSolve",h),r.preSolveAll(S),d=0;d<i.constraintIterations;d++)r.solveAll(x,c);r.postSolveAll(S);var w=o.collisions(C);u.update(T,w,p),i.enableSleeping&&l.afterCollisions(T.list),T.collisionStart.length>0&&n.trigger(i,"collisionStart",{pairs:T.collisionStart,timestamp:m.timestamp,delta:c});var M=t.clamp(20/i.positionIterations,0,1);for(s.preSolvePosition(T.list),d=0;d<i.positionIterations;d++)s.solvePosition(T.list,c,M);for(s.postSolvePosition(S),r.preSolveAll(S),d=0;d<i.constraintIterations;d++)r.solveAll(x,c);for(r.postSolveAll(S),s.preSolveVelocity(T.list),d=0;d<i.velocityIterations;d++)s.solveVelocity(T.list,c);return e._bodiesUpdateVelocities(S),T.collisionActive.length>0&&n.trigger(i,"collisionActive",{pairs:T.collisionActive,timestamp:m.timestamp,delta:c}),T.collisionEnd.length>0&&n.trigger(i,"collisionEnd",{pairs:T.collisionEnd,timestamp:m.timestamp,delta:c}),e._bodiesClearForces(S),n.trigger(i,"afterUpdate",h),i.timing.lastElapsed=t.now()-g,i},e.merge=function(i,c){if(t.extend(i,c),c.world){i.world=c.world,e.clear(i);for(var g=v.allBodies(i.world),y=0;y<g.length;y++){var C=g[y];l.set(C,!1),C.id=t.nextId()}}},e.clear=function(i){u.clear(i.pairs),o.clear(i.detector)},e._bodiesClearForces=function(i){for(var c=i.length,g=0;g<c;g++){var y=i[g];y.force.x=0,y.force.y=0,y.torque=0}},e._bodiesApplyGravity=function(i,c){var g=typeof c.scale<"u"?c.scale:.001,y=i.length;if(!(c.x===0&&c.y===0||g===0))for(var C=0;C<y;C++){var T=i[C];T.isStatic||T.isSleeping||(T.force.y+=T.mass*c.y*g,T.force.x+=T.mass*c.x*g)}},e._bodiesUpdate=function(i,c){for(var g=i.length,y=0;y<g;y++){var C=i[y];C.isStatic||C.isSleeping||a.update(C,c)}},e._bodiesUpdateVelocities=function(i){for(var c=i.length,g=0;g<c;g++)a.updateVelocities(i[g])}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(3),s=f(0),o=f(1);(function(){e._restingThresh=2,e._restingThreshTangent=Math.sqrt(6),e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e._frictionMaxStatic=Number.MAX_VALUE,e.preSolvePosition=function(u){var n,v,r,t=u.length;for(n=0;n<t;n++)v=u[n],v.isActive&&(r=v.contactCount,v.collision.parentA.totalContacts+=r,v.collision.parentB.totalContacts+=r)},e.solvePosition=function(u,n,v){var r,t,a,i,c,g,y,C,T=e._positionDampen*(v||1),m=s.clamp(n/s._baseDelta,0,1),p=u.length;for(r=0;r<p;r++)t=u[r],!(!t.isActive||t.isSensor)&&(a=t.collision,i=a.parentA,c=a.parentB,g=a.normal,t.separation=a.depth+g.x*(c.positionImpulse.x-i.positionImpulse.x)+g.y*(c.positionImpulse.y-i.positionImpulse.y));for(r=0;r<p;r++)t=u[r],!(!t.isActive||t.isSensor)&&(a=t.collision,i=a.parentA,c=a.parentB,g=a.normal,C=t.separation-t.slop*m,(i.isStatic||c.isStatic)&&(C*=2),i.isStatic||i.isSleeping||(y=T/i.totalContacts,i.positionImpulse.x+=g.x*C*y,i.positionImpulse.y+=g.y*C*y),c.isStatic||c.isSleeping||(y=T/c.totalContacts,c.positionImpulse.x-=g.x*C*y,c.positionImpulse.y-=g.y*C*y))},e.postSolvePosition=function(u){for(var n=e._positionWarming,v=u.length,r=l.translate,t=o.update,a=0;a<v;a++){var i=u[a],c=i.positionImpulse,g=c.x,y=c.y,C=i.velocity;if(i.totalContacts=0,g!==0||y!==0){for(var T=0;T<i.parts.length;T++){var m=i.parts[T];r(m.vertices,c),t(m.bounds,m.vertices,C),m.position.x+=g,m.position.y+=y}i.positionPrev.x+=g,i.positionPrev.y+=y,g*C.x+y*C.y<0?(c.x=0,c.y=0):(c.x*=n,c.y*=n)}}},e.preSolveVelocity=function(u){var n=u.length,v,r;for(v=0;v<n;v++){var t=u[v];if(!(!t.isActive||t.isSensor)){var a=t.contacts,i=t.contactCount,c=t.collision,g=c.parentA,y=c.parentB,C=c.normal,T=c.tangent;for(r=0;r<i;r++){var m=a[r],p=m.vertex,d=m.normalImpulse,h=m.tangentImpulse;if(d!==0||h!==0){var S=C.x*d+T.x*h,x=C.y*d+T.y*h;g.isStatic||g.isSleeping||(g.positionPrev.x+=S*g.inverseMass,g.positionPrev.y+=x*g.inverseMass,g.anglePrev+=g.inverseInertia*((p.x-g.position.x)*x-(p.y-g.position.y)*S)),y.isStatic||y.isSleeping||(y.positionPrev.x-=S*y.inverseMass,y.positionPrev.y-=x*y.inverseMass,y.anglePrev-=y.inverseInertia*((p.x-y.position.x)*x-(p.y-y.position.y)*S))}}}}},e.solveVelocity=function(u,n){var v=n/s._baseDelta,r=v*v,t=r*v,a=-e._restingThresh*v,i=e._restingThreshTangent,c=e._frictionNormalMultiplier*v,g=e._frictionMaxStatic,y=u.length,C,T,m,p;for(m=0;m<y;m++){var d=u[m];if(!(!d.isActive||d.isSensor)){var h=d.collision,S=h.parentA,x=h.parentB,w=h.normal.x,M=h.normal.y,A=h.tangent.x,F=h.tangent.y,R=d.inverseMass,k=d.friction*d.frictionStatic*c,L=d.contacts,O=d.contactCount,V=1/O,U=S.position.x-S.positionPrev.x,W=S.position.y-S.positionPrev.y,$=S.angle-S.anglePrev,z=x.position.x-x.positionPrev.x,J=x.position.y-x.positionPrev.y,b=x.angle-x.anglePrev;for(p=0;p<O;p++){var H=L[p],X=H.vertex,N=X.x-S.position.x,te=X.y-S.position.y,j=X.x-x.position.x,K=X.y-x.position.y,Y=U-te*$,Le=W+N*$,ke=z-K*b,Oe=J+j*b,ve=Y-ke,me=Le-Oe,le=w*ve+M*me,Z=A*ve+F*me,he=d.separation+le,ce=Math.min(he,1);ce=he<0?0:ce;var pe=ce*k;Z<-pe||Z>pe?(T=Z>0?Z:-Z,C=d.friction*(Z>0?1:-1)*t,C<-T?C=-T:C>T&&(C=T)):(C=Z,T=g);var ge=N*M-te*w,de=j*M-K*w,xe=V/(R+S.inverseInertia*ge*ge+x.inverseInertia*de*de),ae=(1+d.restitution)*le*xe;if(C*=xe,le<a)H.normalImpulse=0;else{var He=H.normalImpulse;H.normalImpulse+=ae,H.normalImpulse>0&&(H.normalImpulse=0),ae=H.normalImpulse-He}if(Z<-i||Z>i)H.tangentImpulse=0;else{var Ve=H.tangentImpulse;H.tangentImpulse+=C,H.tangentImpulse<-T&&(H.tangentImpulse=-T),H.tangentImpulse>T&&(H.tangentImpulse=T),C=H.tangentImpulse-Ve}var oe=w*ae+A*C,re=M*ae+F*C;S.isStatic||S.isSleeping||(S.positionPrev.x+=oe*S.inverseMass,S.positionPrev.y+=re*S.inverseMass,S.anglePrev+=(N*re-te*oe)*S.inverseInertia),x.isStatic||x.isSleeping||(x.positionPrev.x-=oe*x.inverseMass,x.positionPrev.y-=re*x.inverseMass,x.anglePrev-=(j*re-K*oe)*x.inverseInertia)}}}}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(9),s=f(0);(function(){e.create=function(o){return s.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},o)},e.update=function(o,u,n){var v=l.update,r=l.create,t=l.setActive,a=o.table,i=o.list,c=i.length,g=c,y=o.collisionStart,C=o.collisionEnd,T=o.collisionActive,m=u.length,p=0,d=0,h=0,S,x,w;for(w=0;w<m;w++)S=u[w],x=S.pair,x?(x.isActive&&(T[h++]=x),v(x,S,n)):(x=r(S,n),a[x.id]=x,y[p++]=x,i[g++]=x);for(g=0,c=i.length,w=0;w<c;w++)x=i[w],x.timeUpdated>=n?i[g++]=x:(t(x,!1,n),x.collision.bodyA.sleepCounter>0&&x.collision.bodyB.sleepCounter>0?i[g++]=x:(C[d++]=x,delete a[x.id]));i.length!==g&&(i.length=g),y.length!==p&&(y.length=p),C.length!==d&&(C.length=d),T.length!==h&&(T.length=h)},e.clear=function(o){return o.table={},o.list.length=0,o.collisionStart.length=0,o.collisionActive.length=0,o.collisionEnd.length=0,o}})()}),(function(P,E,f){var e=P.exports=f(21);e.Axes=f(11),e.Bodies=f(12),e.Body=f(4),e.Bounds=f(1),e.Collision=f(8),e.Common=f(0),e.Composite=f(6),e.Composites=f(22),e.Constraint=f(10),e.Contact=f(16),e.Detector=f(13),e.Engine=f(17),e.Events=f(5),e.Grid=f(23),e.Mouse=f(14),e.MouseConstraint=f(24),e.Pair=f(9),e.Pairs=f(19),e.Plugin=f(15),e.Query=f(25),e.Render=f(26),e.Resolver=f(18),e.Runner=f(27),e.SAT=f(28),e.Sleeping=f(7),e.Svg=f(29),e.Vector=f(2),e.Vertices=f(3),e.World=f(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run âž¤ use Matter.Runner.run(engine) instead")}),(function(P,E,f){var e={};P.exports=e;var l=f(15),s=f(0);(function(){e.name="matter-js",e.version="0.20.0",e.uses=[],e.used=[],e.use=function(){l.use(e,Array.prototype.slice.call(arguments))},e.before=function(o,u){return o=o.replace(/^Matter./,""),s.chainPathBefore(e,o,u)},e.after=function(o,u){return o=o.replace(/^Matter./,""),s.chainPathAfter(e,o,u)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(6),s=f(10),o=f(0),u=f(4),n=f(12),v=o.deprecated;(function(){e.stack=function(r,t,a,i,c,g,y){for(var C=l.create({label:"Stack"}),T=r,m=t,p,d=0,h=0;h<i;h++){for(var S=0,x=0;x<a;x++){var w=y(T,m,x,h,p,d);if(w){var M=w.bounds.max.y-w.bounds.min.y,A=w.bounds.max.x-w.bounds.min.x;M>S&&(S=M),u.translate(w,{x:A*.5,y:M*.5}),T=w.bounds.max.x+c,l.addBody(C,w),p=w,d+=1}else T+=c}m+=S+g,T=r}return C},e.chain=function(r,t,a,i,c,g){for(var y=r.bodies,C=1;C<y.length;C++){var T=y[C-1],m=y[C],p=T.bounds.max.y-T.bounds.min.y,d=T.bounds.max.x-T.bounds.min.x,h=m.bounds.max.y-m.bounds.min.y,S=m.bounds.max.x-m.bounds.min.x,x={bodyA:T,pointA:{x:d*t,y:p*a},bodyB:m,pointB:{x:S*i,y:h*c}},w=o.extend(x,g);l.addConstraint(r,s.create(w))}return r.label+=" Chain",r},e.mesh=function(r,t,a,i,c){var g=r.bodies,y,C,T,m,p;for(y=0;y<a;y++){for(C=1;C<t;C++)T=g[C-1+y*t],m=g[C+y*t],l.addConstraint(r,s.create(o.extend({bodyA:T,bodyB:m},c)));if(y>0)for(C=0;C<t;C++)T=g[C+(y-1)*t],m=g[C+y*t],l.addConstraint(r,s.create(o.extend({bodyA:T,bodyB:m},c))),i&&C>0&&(p=g[C-1+(y-1)*t],l.addConstraint(r,s.create(o.extend({bodyA:p,bodyB:m},c)))),i&&C<t-1&&(p=g[C+1+(y-1)*t],l.addConstraint(r,s.create(o.extend({bodyA:p,bodyB:m},c))))}return r.label+=" Mesh",r},e.pyramid=function(r,t,a,i,c,g,y){return e.stack(r,t,a,i,c,g,function(C,T,m,p,d,h){var S=Math.min(i,Math.ceil(a/2)),x=d?d.bounds.max.x-d.bounds.min.x:0;if(!(p>S)){p=S-p;var w=p,M=a-1-p;if(!(m<w||m>M)){h===1&&u.translate(d,{x:(m+(a%2===1?1:-1))*x,y:0});var A=d?m*x:0;return y(r+A+m*c,T,m,p,d,h)}}})},e.newtonsCradle=function(r,t,a,i,c){for(var g=l.create({label:"Newtons Cradle"}),y=0;y<a;y++){var C=1.9,T=n.circle(r+y*(i*C),t+c,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),m=s.create({pointA:{x:r+y*(i*C),y:t},bodyB:T});l.addBody(g,T),l.addConstraint(g,m)}return g},v(e,"newtonsCradle","Composites.newtonsCradle âž¤ moved to newtonsCradle example"),e.car=function(r,t,a,i,c){var g=u.nextGroup(!0),y=20,C=-a*.5+y,T=a*.5-y,m=0,p=l.create({label:"Car"}),d=n.rectangle(r,t,a,i,{collisionFilter:{group:g},chamfer:{radius:i*.5},density:2e-4}),h=n.circle(r+C,t+m,c,{collisionFilter:{group:g},friction:.8}),S=n.circle(r+T,t+m,c,{collisionFilter:{group:g},friction:.8}),x=s.create({bodyB:d,pointB:{x:C,y:m},bodyA:h,stiffness:1,length:0}),w=s.create({bodyB:d,pointB:{x:T,y:m},bodyA:S,stiffness:1,length:0});return l.addBody(p,d),l.addBody(p,h),l.addBody(p,S),l.addConstraint(p,x),l.addConstraint(p,w),p},v(e,"car","Composites.car âž¤ moved to car example"),e.softBody=function(r,t,a,i,c,g,y,C,T,m){T=o.extend({inertia:1/0},T),m=o.extend({stiffness:.2,render:{type:"line",anchors:!1}},m);var p=e.stack(r,t,a,i,c,g,function(d,h){return n.circle(d,h,C,T)});return e.mesh(p,a,i,y,m),p.label="Soft Body",p},v(e,"softBody","Composites.softBody âž¤ moved to softBody and cloth examples")})()}),(function(P,E,f){var e={};P.exports=e;var l=f(9),s=f(0),o=s.deprecated;(function(){e.create=function(u){var n={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return s.extend(n,u)},e.update=function(u,n,v,r){var t,a,i,c=v.world,g=u.buckets,y,C,T=!1;for(t=0;t<n.length;t++){var m=n[t];if(!(m.isSleeping&&!r)&&!(c.bounds&&(m.bounds.max.x<c.bounds.min.x||m.bounds.min.x>c.bounds.max.x||m.bounds.max.y<c.bounds.min.y||m.bounds.min.y>c.bounds.max.y))){var p=e._getRegion(u,m);if(!m.region||p.id!==m.region.id||r){(!m.region||r)&&(m.region=p);var d=e._regionUnion(p,m.region);for(a=d.startCol;a<=d.endCol;a++)for(i=d.startRow;i<=d.endRow;i++){C=e._getBucketId(a,i),y=g[C];var h=a>=p.startCol&&a<=p.endCol&&i>=p.startRow&&i<=p.endRow,S=a>=m.region.startCol&&a<=m.region.endCol&&i>=m.region.startRow&&i<=m.region.endRow;!h&&S&&S&&y&&e._bucketRemoveBody(u,y,m),(m.region===p||h&&!S||r)&&(y||(y=e._createBucket(g,C)),e._bucketAddBody(u,y,m))}m.region=p,T=!0}}}T&&(u.pairsList=e._createActivePairsList(u))},o(e,"update","Grid.update âž¤ replaced by Matter.Detector"),e.clear=function(u){u.buckets={},u.pairs={},u.pairsList=[]},o(e,"clear","Grid.clear âž¤ replaced by Matter.Detector"),e._regionUnion=function(u,n){var v=Math.min(u.startCol,n.startCol),r=Math.max(u.endCol,n.endCol),t=Math.min(u.startRow,n.startRow),a=Math.max(u.endRow,n.endRow);return e._createRegion(v,r,t,a)},e._getRegion=function(u,n){var v=n.bounds,r=Math.floor(v.min.x/u.bucketWidth),t=Math.floor(v.max.x/u.bucketWidth),a=Math.floor(v.min.y/u.bucketHeight),i=Math.floor(v.max.y/u.bucketHeight);return e._createRegion(r,t,a,i)},e._createRegion=function(u,n,v,r){return{id:u+","+n+","+v+","+r,startCol:u,endCol:n,startRow:v,endRow:r}},e._getBucketId=function(u,n){return"C"+u+"R"+n},e._createBucket=function(u,n){var v=u[n]=[];return v},e._bucketAddBody=function(u,n,v){var r=u.pairs,t=l.id,a=n.length,i;for(i=0;i<a;i++){var c=n[i];if(!(v.id===c.id||v.isStatic&&c.isStatic)){var g=t(v,c),y=r[g];y?y[2]+=1:r[g]=[v,c,1]}}n.push(v)},e._bucketRemoveBody=function(u,n,v){var r=u.pairs,t=l.id,a;n.splice(s.indexOf(n,v),1);var i=n.length;for(a=0;a<i;a++){var c=r[t(v,n[a])];c&&(c[2]-=1)}},e._createActivePairsList=function(u){var n,v=u.pairs,r=s.keys(v),t=r.length,a=[],i;for(i=0;i<t;i++)n=v[r[i]],n[2]>0?a.push(n):delete v[r[i]];return a}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(3),s=f(7),o=f(14),u=f(5),n=f(13),v=f(10),r=f(6),t=f(0),a=f(1);(function(){e.create=function(i,c){var g=(i?i.mouse:null)||(c?c.mouse:null);g||(i&&i.render&&i.render.canvas?g=o.create(i.render.canvas):c&&c.element?g=o.create(c.element):(g=o.create(),t.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var y=v.create({label:"Mouse Constraint",pointA:g.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),C={type:"mouseConstraint",mouse:g,element:null,body:null,constraint:y,collisionFilter:{category:1,mask:4294967295,group:0}},T=t.extend(C,c);return u.on(i,"beforeUpdate",function(){var m=r.allBodies(i.world);e.update(T,m),e._triggerEvents(T)}),T},e.update=function(i,c){var g=i.mouse,y=i.constraint,C=i.body;if(g.button===0){if(y.bodyB)s.set(y.bodyB,!1),y.pointA=g.position;else for(var T=0;T<c.length;T++)if(C=c[T],a.contains(C.bounds,g.position)&&n.canCollide(C.collisionFilter,i.collisionFilter))for(var m=C.parts.length>1?1:0;m<C.parts.length;m++){var p=C.parts[m];if(l.contains(p.vertices,g.position)){y.pointA=g.position,y.bodyB=i.body=C,y.pointB={x:g.position.x-C.position.x,y:g.position.y-C.position.y},y.angleB=C.angle,s.set(C,!1),u.trigger(i,"startdrag",{mouse:g,body:C});break}}}else y.bodyB=i.body=null,y.pointB=null,C&&u.trigger(i,"enddrag",{mouse:g,body:C})},e._triggerEvents=function(i){var c=i.mouse,g=c.sourceEvents;g.mousemove&&u.trigger(i,"mousemove",{mouse:c}),g.mousedown&&u.trigger(i,"mousedown",{mouse:c}),g.mouseup&&u.trigger(i,"mouseup",{mouse:c}),o.clearSourceEvents(c)}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(2),s=f(8),o=f(1),u=f(12),n=f(3);(function(){e.collides=function(v,r){for(var t=[],a=r.length,i=v.bounds,c=s.collides,g=o.overlaps,y=0;y<a;y++){var C=r[y],T=C.parts.length,m=T===1?0:1;if(g(C.bounds,i))for(var p=m;p<T;p++){var d=C.parts[p];if(g(d.bounds,i)){var h=c(d,v);if(h){t.push(h);break}}}}return t},e.ray=function(v,r,t,a){a=a||1e-100;for(var i=l.angle(r,t),c=l.magnitude(l.sub(r,t)),g=(t.x+r.x)*.5,y=(t.y+r.y)*.5,C=u.rectangle(g,y,c,a,{angle:i}),T=e.collides(C,v),m=0;m<T.length;m+=1){var p=T[m];p.body=p.bodyB=p.bodyA}return T},e.region=function(v,r,t){for(var a=[],i=0;i<v.length;i++){var c=v[i],g=o.overlaps(c.bounds,r);(g&&!t||!g&&t)&&a.push(c)}return a},e.point=function(v,r){for(var t=[],a=0;a<v.length;a++){var i=v[a];if(o.contains(i.bounds,r))for(var c=i.parts.length===1?0:1;c<i.parts.length;c++){var g=i.parts[c];if(o.contains(g.bounds,r)&&n.contains(g.vertices,r)){t.push(i);break}}}return t}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(4),s=f(0),o=f(6),u=f(1),n=f(5),v=f(2),r=f(14);(function(){var t,a;typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(function(){m(s.now())},1e3/60)},a=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(m){var p={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!m.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},d=s.extend(p,m);return d.canvas&&(d.canvas.width=d.options.width||d.canvas.width,d.canvas.height=d.options.height||d.canvas.height),d.mouse=m.mouse,d.engine=m.engine,d.canvas=d.canvas||g(d.options.width,d.options.height),d.context=d.canvas.getContext("2d"),d.textures={},d.bounds=d.bounds||{min:{x:0,y:0},max:{x:d.canvas.width,y:d.canvas.height}},d.controller=e,d.options.showBroadphase=!1,d.options.pixelRatio!==1&&e.setPixelRatio(d,d.options.pixelRatio),s.isElement(d.element)&&d.element.appendChild(d.canvas),d},e.run=function(m){(function p(d){m.frameRequestId=t(p),i(m,d),e.world(m,d),m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0),(m.options.showStats||m.options.showDebug)&&e.stats(m,m.context,d),(m.options.showPerformance||m.options.showDebug)&&e.performance(m,m.context,d),m.context.setTransform(1,0,0,1,0,0)})()},e.stop=function(m){a(m.frameRequestId)},e.setPixelRatio=function(m,p){var d=m.options,h=m.canvas;p==="auto"&&(p=y(h)),d.pixelRatio=p,h.setAttribute("data-pixel-ratio",p),h.width=d.width*p,h.height=d.height*p,h.style.width=d.width+"px",h.style.height=d.height+"px"},e.setSize=function(m,p,d){m.options.width=p,m.options.height=d,m.bounds.max.x=m.bounds.min.x+p,m.bounds.max.y=m.bounds.min.y+d,m.options.pixelRatio!==1?e.setPixelRatio(m,m.options.pixelRatio):(m.canvas.width=p,m.canvas.height=d)},e.lookAt=function(m,p,d,h){h=typeof h<"u"?h:!0,p=s.isArray(p)?p:[p],d=d||{x:0,y:0};for(var S={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},x=0;x<p.length;x+=1){var w=p[x],M=w.bounds?w.bounds.min:w.min||w.position||w,A=w.bounds?w.bounds.max:w.max||w.position||w;M&&A&&(M.x<S.min.x&&(S.min.x=M.x),A.x>S.max.x&&(S.max.x=A.x),M.y<S.min.y&&(S.min.y=M.y),A.y>S.max.y&&(S.max.y=A.y))}var F=S.max.x-S.min.x+2*d.x,R=S.max.y-S.min.y+2*d.y,k=m.canvas.height,L=m.canvas.width,O=L/k,V=F/R,U=1,W=1;V>O?W=V/O:U=O/V,m.options.hasBounds=!0,m.bounds.min.x=S.min.x,m.bounds.max.x=S.min.x+F*U,m.bounds.min.y=S.min.y,m.bounds.max.y=S.min.y+R*W,h&&(m.bounds.min.x+=F*.5-F*U*.5,m.bounds.max.x+=F*.5-F*U*.5,m.bounds.min.y+=R*.5-R*W*.5,m.bounds.max.y+=R*.5-R*W*.5),m.bounds.min.x-=d.x,m.bounds.max.x-=d.x,m.bounds.min.y-=d.y,m.bounds.max.y-=d.y,m.mouse&&(r.setScale(m.mouse,{x:(m.bounds.max.x-m.bounds.min.x)/m.canvas.width,y:(m.bounds.max.y-m.bounds.min.y)/m.canvas.height}),r.setOffset(m.mouse,m.bounds.min))},e.startViewTransform=function(m){var p=m.bounds.max.x-m.bounds.min.x,d=m.bounds.max.y-m.bounds.min.y,h=p/m.options.width,S=d/m.options.height;m.context.setTransform(m.options.pixelRatio/h,0,0,m.options.pixelRatio/S,0,0),m.context.translate(-m.bounds.min.x,-m.bounds.min.y)},e.endViewTransform=function(m){m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0)},e.world=function(m,p){var d=s.now(),h=m.engine,S=h.world,x=m.canvas,w=m.context,M=m.options,A=m.timing,F=o.allBodies(S),R=o.allConstraints(S),k=M.wireframes?M.wireframeBackground:M.background,L=[],O=[],V,U={timestamp:h.timing.timestamp};if(n.trigger(m,"beforeRender",U),m.currentBackground!==k&&T(m,k),w.globalCompositeOperation="source-in",w.fillStyle="transparent",w.fillRect(0,0,x.width,x.height),w.globalCompositeOperation="source-over",M.hasBounds){for(V=0;V<F.length;V++){var W=F[V];u.overlaps(W.bounds,m.bounds)&&L.push(W)}for(V=0;V<R.length;V++){var $=R[V],z=$.bodyA,J=$.bodyB,b=$.pointA,H=$.pointB;z&&(b=v.add(z.position,$.pointA)),J&&(H=v.add(J.position,$.pointB)),!(!b||!H)&&(u.contains(m.bounds,b)||u.contains(m.bounds,H))&&O.push($)}e.startViewTransform(m),m.mouse&&(r.setScale(m.mouse,{x:(m.bounds.max.x-m.bounds.min.x)/m.options.width,y:(m.bounds.max.y-m.bounds.min.y)/m.options.height}),r.setOffset(m.mouse,m.bounds.min))}else O=R,L=F,m.options.pixelRatio!==1&&m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0);!M.wireframes||h.enableSleeping&&M.showSleeping?e.bodies(m,L,w):(M.showConvexHulls&&e.bodyConvexHulls(m,L,w),e.bodyWireframes(m,L,w)),M.showBounds&&e.bodyBounds(m,L,w),(M.showAxes||M.showAngleIndicator)&&e.bodyAxes(m,L,w),M.showPositions&&e.bodyPositions(m,L,w),M.showVelocity&&e.bodyVelocity(m,L,w),M.showIds&&e.bodyIds(m,L,w),M.showSeparations&&e.separations(m,h.pairs.list,w),M.showCollisions&&e.collisions(m,h.pairs.list,w),M.showVertexNumbers&&e.vertexNumbers(m,L,w),M.showMousePosition&&e.mousePosition(m,m.mouse,w),e.constraints(O,w),M.hasBounds&&e.endViewTransform(m),n.trigger(m,"afterRender",U),A.lastElapsed=s.now()-d},e.stats=function(m,p,d){for(var h=m.engine,S=h.world,x=o.allBodies(S),w=0,M=55,A=44,F=0,R=0,k=0;k<x.length;k+=1)w+=x[k].parts.length;var L={Part:w,Body:x.length,Cons:o.allConstraints(S).length,Comp:o.allComposites(S).length,Pair:h.pairs.list.length};p.fillStyle="#0e0f19",p.fillRect(F,R,M*5.5,A),p.font="12px Arial",p.textBaseline="top",p.textAlign="right";for(var O in L){var V=L[O];p.fillStyle="#aaa",p.fillText(O,F+M,R+8),p.fillStyle="#eee",p.fillText(V,F+M,R+26),F+=M}},e.performance=function(m,p){var d=m.engine,h=m.timing,S=h.deltaHistory,x=h.elapsedHistory,w=h.timestampElapsedHistory,M=h.engineDeltaHistory,A=h.engineUpdatesHistory,F=h.engineElapsedHistory,R=d.timing.lastUpdatesPerFrame,k=d.timing.lastDelta,L=c(S),O=c(x),V=c(M),U=c(A),W=c(F),$=c(w),z=$/L||0,J=Math.round(L/k),b=1e3/L||0,H=4,X=12,N=60,te=34,j=10,K=69;p.fillStyle="#0e0f19",p.fillRect(0,50,X*5+N*6+22,te),e.status(p,j,K,N,H,S.length,Math.round(b)+" fps",b/e._goodFps,function(Y){return S[Y]/L-1}),e.status(p,j+X+N,K,N,H,M.length,k.toFixed(2)+" dt",e._goodDelta/k,function(Y){return M[Y]/V-1}),e.status(p,j+(X+N)*2,K,N,H,A.length,R+" upf",Math.pow(s.clamp(U/J||1,0,1),4),function(Y){return A[Y]/U-1}),e.status(p,j+(X+N)*3,K,N,H,F.length,W.toFixed(2)+" ut",1-R*W/e._goodFps,function(Y){return F[Y]/W-1}),e.status(p,j+(X+N)*4,K,N,H,x.length,O.toFixed(2)+" rt",1-O/e._goodFps,function(Y){return x[Y]/O-1}),e.status(p,j+(X+N)*5,K,N,H,w.length,z.toFixed(2)+" x",z*z*z,function(Y){return(w[Y]/S[Y]/z||0)-1})},e.status=function(m,p,d,h,S,x,w,M,A){m.strokeStyle="#888",m.fillStyle="#444",m.lineWidth=1,m.fillRect(p,d+7,h,1),m.beginPath(),m.moveTo(p,d+7-S*s.clamp(.4*A(0),-2,2));for(var F=0;F<h;F+=1)m.lineTo(p+F,d+7-(F<x?S*s.clamp(.4*A(F),-2,2):0));m.stroke(),m.fillStyle="hsl("+s.clamp(25+95*M,0,120)+",100%,60%)",m.fillRect(p,d-7,4,4),m.font="12px Arial",m.textBaseline="middle",m.textAlign="right",m.fillStyle="#eee",m.fillText(w,p+h,d-5)},e.constraints=function(m,p){for(var d=p,h=0;h<m.length;h++){var S=m[h];if(!(!S.render.visible||!S.pointA||!S.pointB)){var x=S.bodyA,w=S.bodyB,M,A;if(x?M=v.add(x.position,S.pointA):M=S.pointA,S.render.type==="pin")d.beginPath(),d.arc(M.x,M.y,3,0,2*Math.PI),d.closePath();else{if(w?A=v.add(w.position,S.pointB):A=S.pointB,d.beginPath(),d.moveTo(M.x,M.y),S.render.type==="spring")for(var F=v.sub(A,M),R=v.perp(v.normalise(F)),k=Math.ceil(s.clamp(S.length/5,12,20)),L,O=1;O<k;O+=1)L=O%2===0?1:-1,d.lineTo(M.x+F.x*(O/k)+R.x*L*4,M.y+F.y*(O/k)+R.y*L*4);d.lineTo(A.x,A.y)}S.render.lineWidth&&(d.lineWidth=S.render.lineWidth,d.strokeStyle=S.render.strokeStyle,d.stroke()),S.render.anchors&&(d.fillStyle=S.render.strokeStyle,d.beginPath(),d.arc(M.x,M.y,3,0,2*Math.PI),d.arc(A.x,A.y,3,0,2*Math.PI),d.closePath(),d.fill())}}},e.bodies=function(m,p,d){var h=d;m.engine;var S=m.options,x=S.showInternalEdges||!S.wireframes,w,M,A,F;for(A=0;A<p.length;A++)if(w=p[A],!!w.render.visible){for(F=w.parts.length>1?1:0;F<w.parts.length;F++)if(M=w.parts[F],!!M.render.visible){if(S.showSleeping&&w.isSleeping?h.globalAlpha=.5*M.render.opacity:M.render.opacity!==1&&(h.globalAlpha=M.render.opacity),M.render.sprite&&M.render.sprite.texture&&!S.wireframes){var R=M.render.sprite,k=C(m,R.texture);h.translate(M.position.x,M.position.y),h.rotate(M.angle),h.drawImage(k,k.width*-R.xOffset*R.xScale,k.height*-R.yOffset*R.yScale,k.width*R.xScale,k.height*R.yScale),h.rotate(-M.angle),h.translate(-M.position.x,-M.position.y)}else{if(M.circleRadius)h.beginPath(),h.arc(M.position.x,M.position.y,M.circleRadius,0,2*Math.PI);else{h.beginPath(),h.moveTo(M.vertices[0].x,M.vertices[0].y);for(var L=1;L<M.vertices.length;L++)!M.vertices[L-1].isInternal||x?h.lineTo(M.vertices[L].x,M.vertices[L].y):h.moveTo(M.vertices[L].x,M.vertices[L].y),M.vertices[L].isInternal&&!x&&h.moveTo(M.vertices[(L+1)%M.vertices.length].x,M.vertices[(L+1)%M.vertices.length].y);h.lineTo(M.vertices[0].x,M.vertices[0].y),h.closePath()}S.wireframes?(h.lineWidth=1,h.strokeStyle=m.options.wireframeStrokeStyle,h.stroke()):(h.fillStyle=M.render.fillStyle,M.render.lineWidth&&(h.lineWidth=M.render.lineWidth,h.strokeStyle=M.render.strokeStyle,h.stroke()),h.fill())}h.globalAlpha=1}}},e.bodyWireframes=function(m,p,d){var h=d,S=m.options.showInternalEdges,x,w,M,A,F;for(h.beginPath(),M=0;M<p.length;M++)if(x=p[M],!!x.render.visible)for(F=x.parts.length>1?1:0;F<x.parts.length;F++){for(w=x.parts[F],h.moveTo(w.vertices[0].x,w.vertices[0].y),A=1;A<w.vertices.length;A++)!w.vertices[A-1].isInternal||S?h.lineTo(w.vertices[A].x,w.vertices[A].y):h.moveTo(w.vertices[A].x,w.vertices[A].y),w.vertices[A].isInternal&&!S&&h.moveTo(w.vertices[(A+1)%w.vertices.length].x,w.vertices[(A+1)%w.vertices.length].y);h.lineTo(w.vertices[0].x,w.vertices[0].y)}h.lineWidth=1,h.strokeStyle=m.options.wireframeStrokeStyle,h.stroke()},e.bodyConvexHulls=function(m,p,d){var h=d,S,x,w;for(h.beginPath(),x=0;x<p.length;x++)if(S=p[x],!(!S.render.visible||S.parts.length===1)){for(h.moveTo(S.vertices[0].x,S.vertices[0].y),w=1;w<S.vertices.length;w++)h.lineTo(S.vertices[w].x,S.vertices[w].y);h.lineTo(S.vertices[0].x,S.vertices[0].y)}h.lineWidth=1,h.strokeStyle="rgba(255,255,255,0.2)",h.stroke()},e.vertexNumbers=function(m,p,d){var h=d,S,x,w;for(S=0;S<p.length;S++){var M=p[S].parts;for(w=M.length>1?1:0;w<M.length;w++){var A=M[w];for(x=0;x<A.vertices.length;x++)h.fillStyle="rgba(255,255,255,0.2)",h.fillText(S+"_"+x,A.position.x+(A.vertices[x].x-A.position.x)*.8,A.position.y+(A.vertices[x].y-A.position.y)*.8)}}},e.mousePosition=function(m,p,d){var h=d;h.fillStyle="rgba(255,255,255,0.8)",h.fillText(p.position.x+"  "+p.position.y,p.position.x+5,p.position.y-5)},e.bodyBounds=function(m,p,d){var h=d;m.engine;var S=m.options;h.beginPath();for(var x=0;x<p.length;x++){var w=p[x];if(w.render.visible)for(var M=p[x].parts,A=M.length>1?1:0;A<M.length;A++){var F=M[A];h.rect(F.bounds.min.x,F.bounds.min.y,F.bounds.max.x-F.bounds.min.x,F.bounds.max.y-F.bounds.min.y)}}S.wireframes?h.strokeStyle="rgba(255,255,255,0.08)":h.strokeStyle="rgba(0,0,0,0.1)",h.lineWidth=1,h.stroke()},e.bodyAxes=function(m,p,d){var h=d;m.engine;var S=m.options,x,w,M,A;for(h.beginPath(),w=0;w<p.length;w++){var F=p[w],R=F.parts;if(F.render.visible)if(S.showAxes)for(M=R.length>1?1:0;M<R.length;M++)for(x=R[M],A=0;A<x.axes.length;A++){var k=x.axes[A];h.moveTo(x.position.x,x.position.y),h.lineTo(x.position.x+k.x*20,x.position.y+k.y*20)}else for(M=R.length>1?1:0;M<R.length;M++)for(x=R[M],A=0;A<x.axes.length;A++)h.moveTo(x.position.x,x.position.y),h.lineTo((x.vertices[0].x+x.vertices[x.vertices.length-1].x)/2,(x.vertices[0].y+x.vertices[x.vertices.length-1].y)/2)}S.wireframes?(h.strokeStyle="indianred",h.lineWidth=1):(h.strokeStyle="rgba(255, 255, 255, 0.4)",h.globalCompositeOperation="overlay",h.lineWidth=2),h.stroke(),h.globalCompositeOperation="source-over"},e.bodyPositions=function(m,p,d){var h=d;m.engine;var S=m.options,x,w,M,A;for(h.beginPath(),M=0;M<p.length;M++)if(x=p[M],!!x.render.visible)for(A=0;A<x.parts.length;A++)w=x.parts[A],h.arc(w.position.x,w.position.y,3,0,2*Math.PI,!1),h.closePath();for(S.wireframes?h.fillStyle="indianred":h.fillStyle="rgba(0,0,0,0.5)",h.fill(),h.beginPath(),M=0;M<p.length;M++)x=p[M],x.render.visible&&(h.arc(x.positionPrev.x,x.positionPrev.y,2,0,2*Math.PI,!1),h.closePath());h.fillStyle="rgba(255,165,0,0.8)",h.fill()},e.bodyVelocity=function(m,p,d){var h=d;h.beginPath();for(var S=0;S<p.length;S++){var x=p[S];if(x.render.visible){var w=l.getVelocity(x);h.moveTo(x.position.x,x.position.y),h.lineTo(x.position.x+w.x,x.position.y+w.y)}}h.lineWidth=3,h.strokeStyle="cornflowerblue",h.stroke()},e.bodyIds=function(m,p,d){var h=d,S,x;for(S=0;S<p.length;S++)if(p[S].render.visible){var w=p[S].parts;for(x=w.length>1?1:0;x<w.length;x++){var M=w[x];h.font="12px Arial",h.fillStyle="rgba(255,255,255,0.5)",h.fillText(M.id,M.position.x+10,M.position.y-10)}}},e.collisions=function(m,p,d){var h=d,S=m.options,x,w,M,A;for(h.beginPath(),M=0;M<p.length;M++)if(x=p[M],!!x.isActive)for(w=x.collision,A=0;A<x.contactCount;A++){var F=x.contacts[A],R=F.vertex;h.rect(R.x-1.5,R.y-1.5,3.5,3.5)}for(S.wireframes?h.fillStyle="rgba(255,255,255,0.7)":h.fillStyle="orange",h.fill(),h.beginPath(),M=0;M<p.length;M++)if(x=p[M],!!x.isActive&&(w=x.collision,x.contactCount>0)){var k=x.contacts[0].vertex.x,L=x.contacts[0].vertex.y;x.contactCount===2&&(k=(x.contacts[0].vertex.x+x.contacts[1].vertex.x)/2,L=(x.contacts[0].vertex.y+x.contacts[1].vertex.y)/2),w.bodyB===w.supports[0].body||w.bodyA.isStatic===!0?h.moveTo(k-w.normal.x*8,L-w.normal.y*8):h.moveTo(k+w.normal.x*8,L+w.normal.y*8),h.lineTo(k,L)}S.wireframes?h.strokeStyle="rgba(255,165,0,0.7)":h.strokeStyle="orange",h.lineWidth=1,h.stroke()},e.separations=function(m,p,d){var h=d,S=m.options,x,w,M,A,F;for(h.beginPath(),F=0;F<p.length;F++)if(x=p[F],!!x.isActive){w=x.collision,M=w.bodyA,A=w.bodyB;var R=1;!A.isStatic&&!M.isStatic&&(R=.5),A.isStatic&&(R=0),h.moveTo(A.position.x,A.position.y),h.lineTo(A.position.x-w.penetration.x*R,A.position.y-w.penetration.y*R),R=1,!A.isStatic&&!M.isStatic&&(R=.5),M.isStatic&&(R=0),h.moveTo(M.position.x,M.position.y),h.lineTo(M.position.x+w.penetration.x*R,M.position.y+w.penetration.y*R)}S.wireframes?h.strokeStyle="rgba(255,165,0,0.5)":h.strokeStyle="orange",h.stroke()},e.inspector=function(m,p){m.engine;var d=m.selected,h=m.render,S=h.options,x;if(S.hasBounds){var w=h.bounds.max.x-h.bounds.min.x,M=h.bounds.max.y-h.bounds.min.y,A=w/h.options.width,F=M/h.options.height;p.scale(1/A,1/F),p.translate(-h.bounds.min.x,-h.bounds.min.y)}for(var R=0;R<d.length;R++){var k=d[R].data;switch(p.translate(.5,.5),p.lineWidth=1,p.strokeStyle="rgba(255,165,0,0.9)",p.setLineDash([1,2]),k.type){case"body":x=k.bounds,p.beginPath(),p.rect(Math.floor(x.min.x-3),Math.floor(x.min.y-3),Math.floor(x.max.x-x.min.x+6),Math.floor(x.max.y-x.min.y+6)),p.closePath(),p.stroke();break;case"constraint":var L=k.pointA;k.bodyA&&(L=k.pointB),p.beginPath(),p.arc(L.x,L.y,10,0,2*Math.PI),p.closePath(),p.stroke();break}p.setLineDash([]),p.translate(-.5,-.5)}m.selectStart!==null&&(p.translate(.5,.5),p.lineWidth=1,p.strokeStyle="rgba(255,165,0,0.6)",p.fillStyle="rgba(255,165,0,0.1)",x=m.selectBounds,p.beginPath(),p.rect(Math.floor(x.min.x),Math.floor(x.min.y),Math.floor(x.max.x-x.min.x),Math.floor(x.max.y-x.min.y)),p.closePath(),p.stroke(),p.fill(),p.translate(-.5,-.5)),S.hasBounds&&p.setTransform(1,0,0,1,0,0)};var i=function(m,p){var d=m.engine,h=m.timing,S=h.historySize,x=d.timing.timestamp;h.delta=p-h.lastTime||e._goodDelta,h.lastTime=p,h.timestampElapsed=x-h.lastTimestamp||0,h.lastTimestamp=x,h.deltaHistory.unshift(h.delta),h.deltaHistory.length=Math.min(h.deltaHistory.length,S),h.engineDeltaHistory.unshift(d.timing.lastDelta),h.engineDeltaHistory.length=Math.min(h.engineDeltaHistory.length,S),h.timestampElapsedHistory.unshift(h.timestampElapsed),h.timestampElapsedHistory.length=Math.min(h.timestampElapsedHistory.length,S),h.engineUpdatesHistory.unshift(d.timing.lastUpdatesPerFrame),h.engineUpdatesHistory.length=Math.min(h.engineUpdatesHistory.length,S),h.engineElapsedHistory.unshift(d.timing.lastElapsed),h.engineElapsedHistory.length=Math.min(h.engineElapsedHistory.length,S),h.elapsedHistory.unshift(h.lastElapsed),h.elapsedHistory.length=Math.min(h.elapsedHistory.length,S)},c=function(m){for(var p=0,d=0;d<m.length;d+=1)p+=m[d];return p/m.length||0},g=function(m,p){var d=document.createElement("canvas");return d.width=m,d.height=p,d.oncontextmenu=function(){return!1},d.onselectstart=function(){return!1},d},y=function(m){var p=m.getContext("2d"),d=window.devicePixelRatio||1,h=p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1;return d/h},C=function(m,p){var d=m.textures[p];return d||(d=m.textures[p]=new Image,d.src=p,d)},T=function(m,p){var d=p;/(jpg|gif|png)$/.test(p)&&(d="url("+p+")"),m.canvas.style.background=d,m.canvas.style.backgroundSize="contain",m.currentBackground=p}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(5),s=f(17),o=f(0);(function(){e._maxFrameDelta=1e3/15,e._frameDeltaFallback=1e3/60,e._timeBufferMargin=1.5,e._elapsedNextEstimate=1,e._smoothingLowerBound=.1,e._smoothingUpperBound=.9,e.create=function(n){var v={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},r=o.extend(v,n);return r.fps=0,r},e.run=function(n,v){return n.timeBuffer=e._frameDeltaFallback,(function r(t){n.frameRequestId=e._onNextFrame(n,r),t&&n.enabled&&e.tick(n,v,t)})(),n},e.tick=function(n,v,r){var t=o.now(),a=n.delta,i=0,c=r-n.timeLastTick;if((!c||!n.timeLastTick||c>Math.max(e._maxFrameDelta,n.maxFrameTime))&&(c=n.frameDelta||e._frameDeltaFallback),n.frameDeltaSmoothing){n.frameDeltaHistory.push(c),n.frameDeltaHistory=n.frameDeltaHistory.slice(-n.frameDeltaHistorySize);var g=n.frameDeltaHistory.slice(0).sort(),y=n.frameDeltaHistory.slice(g.length*e._smoothingLowerBound,g.length*e._smoothingUpperBound),C=u(y);c=C||c}n.frameDeltaSnapping&&(c=1e3/Math.round(1e3/c)),n.frameDelta=c,n.timeLastTick=r,n.timeBuffer+=n.frameDelta,n.timeBuffer=o.clamp(n.timeBuffer,0,n.frameDelta+a*e._timeBufferMargin),n.lastUpdatesDeferred=0;var T=n.maxUpdates||Math.ceil(n.maxFrameTime/a),m={timestamp:v.timing.timestamp};l.trigger(n,"beforeTick",m),l.trigger(n,"tick",m);for(var p=o.now();a>0&&n.timeBuffer>=a*e._timeBufferMargin;){l.trigger(n,"beforeUpdate",m),s.update(v,a),l.trigger(n,"afterUpdate",m),n.timeBuffer-=a,i+=1;var d=o.now()-t,h=o.now()-p,S=d+e._elapsedNextEstimate*h/i;if(i>=T||S>n.maxFrameTime){n.lastUpdatesDeferred=Math.round(Math.max(0,n.timeBuffer/a-e._timeBufferMargin));break}}v.timing.lastUpdatesPerFrame=i,l.trigger(n,"afterTick",m),n.frameDeltaHistory.length>=100&&(n.lastUpdatesDeferred&&Math.round(n.frameDelta/a)>T?o.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):n.lastUpdatesDeferred&&o.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof n.isFixed<"u"&&o.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(n.deltaMin||n.deltaMax)&&o.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),n.fps!==0&&o.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},e.stop=function(n){e._cancelNextFrame(n)},e._onNextFrame=function(n,v){if(typeof window<"u"&&window.requestAnimationFrame)n.frameRequestId=window.requestAnimationFrame(v);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return n.frameRequestId},e._cancelNextFrame=function(n){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(n.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var u=function(n){for(var v=0,r=n.length,t=0;t<r;t+=1)v+=n[t];return v/r||0}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(8),s=f(0),o=s.deprecated;(function(){e.collides=function(u,n){return l.collides(u,n)},o(e,"collides","SAT.collides âž¤ replaced by Collision.collides")})()}),(function(P,E,f){var e={};P.exports=e,f(1);var l=f(0);(function(){e.pathToVertices=function(s,o){typeof window<"u"&&!("SVGPathSeg"in window)&&l.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var u,n,v,r,t,a,i,c,g,y,C=[],T,m,p=0,d=0,h=0;o=o||15;var S=function(w,M,A){var F=A%2===1&&A>1;if(!g||w!=g.x||M!=g.y){g&&F?(T=g.x,m=g.y):(T=0,m=0);var R={x:T+w,y:m+M};(F||!g)&&(g=R),C.push(R),d=T+w,h=m+M}},x=function(w){var M=w.pathSegTypeAsLetter.toUpperCase();if(M!=="Z"){switch(M){case"M":case"L":case"T":case"C":case"S":case"Q":d=w.x,h=w.y;break;case"H":d=w.x;break;case"V":h=w.y;break}S(d,h,w.pathSegType)}};for(e._svgPathToAbsolute(s),v=s.getTotalLength(),a=[],u=0;u<s.pathSegList.numberOfItems;u+=1)a.push(s.pathSegList.getItem(u));for(i=a.concat();p<v;){if(y=s.getPathSegAtLength(p),t=a[y],t!=c){for(;i.length&&i[0]!=t;)x(i.shift());c=t}switch(t.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":r=s.getPointAtLength(p),S(r.x,r.y,0);break}p+=o}for(u=0,n=i.length;u<n;++u)x(i[u]);return C},e._svgPathToAbsolute=function(s){for(var o,u,n,v,r,t,a=s.pathSegList,i=0,c=0,g=a.numberOfItems,y=0;y<g;++y){var C=a.getItem(y),T=C.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(T))"x"in C&&(i=C.x),"y"in C&&(c=C.y);else switch("x1"in C&&(n=i+C.x1),"x2"in C&&(r=i+C.x2),"y1"in C&&(v=c+C.y1),"y2"in C&&(t=c+C.y2),"x"in C&&(i+=C.x),"y"in C&&(c+=C.y),T){case"m":a.replaceItem(s.createSVGPathSegMovetoAbs(i,c),y);break;case"l":a.replaceItem(s.createSVGPathSegLinetoAbs(i,c),y);break;case"h":a.replaceItem(s.createSVGPathSegLinetoHorizontalAbs(i),y);break;case"v":a.replaceItem(s.createSVGPathSegLinetoVerticalAbs(c),y);break;case"c":a.replaceItem(s.createSVGPathSegCurvetoCubicAbs(i,c,n,v,r,t),y);break;case"s":a.replaceItem(s.createSVGPathSegCurvetoCubicSmoothAbs(i,c,r,t),y);break;case"q":a.replaceItem(s.createSVGPathSegCurvetoQuadraticAbs(i,c,n,v),y);break;case"t":a.replaceItem(s.createSVGPathSegCurvetoQuadraticSmoothAbs(i,c),y);break;case"a":a.replaceItem(s.createSVGPathSegArcAbs(i,c,C.r1,C.r2,C.angle,C.largeArcFlag,C.sweepFlag),y);break;case"z":case"Z":i=o,c=u;break}(T=="M"||T=="m")&&(o=i,u=c)}}})()}),(function(P,E,f){var e={};P.exports=e;var l=f(6);f(0),(function(){e.create=l.create,e.add=l.add,e.remove=l.remove,e.clear=l.clear,e.addComposite=l.addComposite,e.addBody=l.addBody,e.addConstraint=l.addConstraint})()})])})})(se)),se.exports}var Ge=$e();const Me=Ue(Ge),{Engine:Ne,Render:ne,Runner:Ce,Bodies:ee,Composite:Q,Events:ze,Body:ie}=Me;class Ye{constructor(){this.ctx=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.ctx.createGain(),this.masterGain.connect(this.ctx.destination),this.masterGain.gain.value=.3,this.enabled=!1}enable(){this.enabled||this.ctx.resume().then(()=>{this.enabled=!0})}playTone(B,P,E,f=0){if(!this.ctx)return;const e=this.ctx.createOscillator(),l=this.ctx.createGain();e.type=P,e.frequency.setValueAtTime(B,this.ctx.currentTime+f),l.gain.setValueAtTime(.5,this.ctx.currentTime+f),l.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+f+E),e.connect(l),l.connect(this.masterGain),e.start(this.ctx.currentTime+f),e.stop(this.ctx.currentTime+f+E)}playSpawn(){this.playTone(300,"sine",.1),this.playTone(450,"sine",.1,.05)}playDrop(){if(!this.ctx)return;const B=this.ctx.createOscillator(),P=this.ctx.createGain();B.frequency.setValueAtTime(600,this.ctx.currentTime),B.frequency.exponentialRampToValueAtTime(200,this.ctx.currentTime+.2),P.gain.setValueAtTime(.3,this.ctx.currentTime),P.gain.linearRampToValueAtTime(0,this.ctx.currentTime+.2),B.connect(P),P.connect(this.masterGain),B.start(),B.stop(this.ctx.currentTime+.2)}playLand(B="normal"){this.playTone(100,"square",.2),this.playTone(50,"sine",.3)}playPerfect(){this.playTone(880,"sine",.4,0),this.playTone(1108,"sine",.4,.05),this.playTone(1320,"sine",.4,.1)}playGood(){this.playTone(300,"triangle",.1)}playGameOver(){if(this.playTone(400,"sawtooth",1.5,0),this.playTone(300,"sawtooth",1.5,.2),this.playTone(200,"sawtooth",1.5,.4),!this.ctx)return;const B=this.ctx.createOscillator(),P=this.ctx.createGain();B.frequency.setValueAtTime(800,this.ctx.currentTime),B.frequency.exponentialRampToValueAtTime(50,this.ctx.currentTime+1.5),P.gain.setValueAtTime(.3,this.ctx.currentTime),P.gain.linearRampToValueAtTime(0,this.ctx.currentTime+1.5),B.connect(P),P.connect(this.masterGain),B.start(),B.stop(this.ctx.currentTime+1.5)}}const _=new Ye;class be{constructor(){this.layer=document.getElementById("background-layer"),this.container=document.getElementById("game-container"),this.objects=[],this.lastCameraY=0,this.landmarks=[{score:3,emoji:"ðŸˆ",size:40,offset:-100,spawned:!1},{score:10,emoji:"ðŸ¦’",size:100,offset:50,spawned:!1},{score:20,emoji:"ðŸ¦•",size:120,offset:-80,spawned:!1},{score:50,emoji:"ðŸ¦…",size:60,offset:120,spawned:!1},{score:100,emoji:"ðŸ—»",size:200,offset:0,spawned:!1},{score:333,emoji:"ðŸ—¼",size:150,offset:80,spawned:!1},{score:634,emoji:"â˜ï¸",size:180,offset:-50,spawned:!1},{score:1e3,emoji:"âœˆï¸",size:80,offset:100,spawned:!1},{score:2e3,emoji:"ðŸ›°ï¸",size:70,offset:-80,spawned:!1},{score:3e3,emoji:"ðŸŒ‘",size:120,offset:0,spawned:!1},{score:5e3,emoji:"ðŸ›¸",size:90,offset:120,spawned:!1},{score:1e4,emoji:"ðŸª",size:200,offset:-50,spawned:!1}]}reset(){this.layer.innerHTML="",this.objects=[],this.landmarks.forEach(B=>B.spawned=!1),this.updateColor(0),this.lastCameraY=0}update(B,P,E,f){this.updateColor(B),this.spawnObjects(B,P,E),this.updatePositions(P,f),this.lastCameraY=P}updateColor(B){const P=[{score:0,color:[239,236,223]},{score:20,color:[255,183,77]},{score:50,color:[40,53,147]},{score:100,color:[10,10,30]}];let E=P[0],f=P[P.length-1];for(let u=0;u<P.length-1;u++)if(B>=P[u].score&&B<P[u+1].score){E=P[u],f=P[u+1];break}else if(B>=P[P.length-1].score){E=P[P.length-1],f=P[P.length-1];break}let e=0;E!==f&&(e=(B-E.score)/(f.score-E.score));const l=Math.round(E.color[0]+(f.color[0]-E.color[0])*e),s=Math.round(E.color[1]+(f.color[1]-E.color[1])*e),o=Math.round(E.color[2]+(f.color[2]-E.color[2])*e);this.container.style.backgroundColor=`rgb(${l}, ${s}, ${o})`,B>=40?(document.getElementById("score-container").style.color="#FFFFFF",document.querySelector(".unit").style.color="#CCCCCC"):(document.getElementById("score-container").style.color="#D72638",document.querySelector(".unit").style.color="#888")}spawnObjects(B,P,E){if(this.landmarks.forEach(f=>{!f.spawned&&B>=f.score&&(this.createLandmark(f,P,E),f.spawned=!0)}),P<this.lastCameraY){const f=this.lastCameraY-P;Math.random()<f*.02&&this.createDecoration(B,P,E)}}createLandmark(B,P,E){const f=document.createElement("div");f.className="bg-object bg-landmark",f.textContent=B.emoji,f.style.fontSize=`${B.size}px`;const e=P-100,l=E/2+B.offset,s={el:f,x:l,y:e,parallax:.2,type:"landmark"};this.layer.appendChild(f),this.objects.push(s)}createDecoration(B,P,E){const f=this.getDecorationType(B);if(!f)return;const e=document.createElement("div");e.className=`bg-object ${f.className}`;const l=Math.random()*E,s=P-100;if(f.className==="bg-cloud"){const u=60+Math.random()*100,n=u*.6;e.style.width=`${u}px`,e.style.height=`${n}px`}else if(f.className==="bg-star"){const u=2+Math.random()*4;e.style.width=`${u}px`,e.style.height=`${u}px`}const o={el:e,x:l,y:s,parallax:f.parallax+Math.random()*.1,type:"decoration"};this.layer.appendChild(e),this.objects.push(o)}getDecorationType(B){return B<10?null:B<50?{className:"bg-cloud",parallax:.5}:B>=80?{className:"bg-star",parallax:.1}:null}updatePositions(B,P){for(let E=this.objects.length-1;E>=0;E--){const f=this.objects[E];f.y-B;const e=f.y-B*f.parallax;if(e>P+100){f.el.remove(),this.objects.splice(E,1);continue}f.el.style.transform=`translate3d(${f.x}px, ${e}px, 0)`}}}const Pe=new be,G={MOCHI_WIDTH:140,MOCHI_HEIGHT:50,MOVE_SPEED:4,DROP_MOCHI_COUNT:5,PLAY_AREA_WIDTH:400},q=[{threshold:0,name:"åº§é ­ç´š",emoji:"ðŸª•",desc:"ç¥ã„ã¨ã‚ã§ãŸã•ã®è±¡å¾´ï¼"},{threshold:3,name:"ç…™è‰ç´š",emoji:"ðŸš¬",desc:"ç¥­ã‚Šã‚„ç¥ã„äº‹ã®å¿…éœ€å“ï¼"},{threshold:6,name:"æ‰‡ç´š",emoji:"ðŸª­",desc:"æœ«åºƒãŒã‚Šã«ç¦ã‚’æ‹›ãï¼"},{threshold:10,name:"èŒ„å­ç´š",emoji:"ðŸ†",desc:"ç‰©äº‹ã‚’æˆã™ï¼ˆç”Ÿã™ï¼‰ï¼"},{threshold:15,name:"é·¹ç´š",emoji:"ðŸ¦…",desc:"å¨åŽ³ã‚ã‚‹ç™¾é³¥ã®çŽ‹ï¼"},{threshold:20,name:"å¯Œå£«ç´š",emoji:"ðŸ—»",desc:"æ—¥æœ¬ä¸€ã®å±±ï¼çµ¶æ™¯ã‹ãªã€‚"}];let I=null;function Xe(){const D=document.getElementById("game-canvas"),B=D.clientWidth||400,P=D.clientHeight||700;D.width=B,D.height=P;const E=Ne.create({gravity:{x:0,y:1}}),f=ne.create({canvas:D,engine:E,options:{width:B,height:P,wireframes:!1,background:"transparent"}});ne.run(f);const e=Ce.create();Ce.run(e,E);const l=P-130;I={engine:E,render:f,runner:e,canvas:D,width:B,height:P,score:0,state:"idle",currentMochi:null,mochiState:"none",stackedMochis:[],moveDir:1,moveX:B/2,cameraY:0,baseTopY:l,baseBottomY:P-40,shake:0,particles:[],combo:0,maxCombo:0,perfectCount:0},je(),Ke();const s=Ie();Ae(s.highScore),Fe()}const Te="kagamimochi_record_v1";function Ie(){try{const D=localStorage.getItem(Te);return D?JSON.parse(D):{highScore:0,maxCombo:0}}catch(D){return console.error("Failed to load record",D),{highScore:0,maxCombo:0}}}function Qe(D,B){try{const P=Ie(),E={highScore:Math.max(P.highScore,D),maxCombo:Math.max(P.maxCombo,B)};return localStorage.setItem(Te,JSON.stringify(E)),E}catch(P){return console.error("Failed to save record",P),{highScore:D,maxCombo:B}}}function Ae(D){const B=document.getElementById("home-best-score");if(B){const P=[...q].reverse().find(E=>E.threshold<=D)||q[0];B.textContent=`BEST: ${D}æ®µ (${P.name})`}}function je(){const{engine:D,width:B,baseTopY:P}=I,E=B/2,f=ee.rectangle(E,P,180,20,{isStatic:!0,label:"base",render:{fillStyle:"#1F1F24",strokeStyle:"#333333",lineWidth:0}}),e=ee.rectangle(E,P+50,100,80,{isStatic:!0,label:"base",render:{fillStyle:"#1F1F24",strokeStyle:"#333333",lineWidth:0}});Q.add(D.world,[f,e])}function Ke(){const{canvas:D}=I;document.getElementById("start-button").onclick=P=>{P.stopPropagation(),Be()},document.getElementById("restart-button").onclick=P=>{P.stopPropagation(),Ze()},document.getElementById("share-button").onclick=P=>{P.stopPropagation(),rt()};const B=P=>{I.state==="playing"&&P.target.tagName!=="BUTTON"&&(P.target.closest(".overlay")||(P.preventDefault(),Je()))};D.addEventListener("click",B),D.addEventListener("touchend",B),ze.on(I.engine,"collisionStart",qe)}function Be(){document.getElementById("start-screen").classList.add("hidden"),document.getElementById("game-over-screen").classList.add("hidden"),I.score=0,I.state="playing",I.stackedMochis=[],I.combo=0,I.maxCombo=0,I.perfectCount=0,I.moveX=I.width/2,I.cameraY=0,document.getElementById("score").textContent="0",document.getElementById("score").textContent="0",Re(),Ee(),Pe.reset(),_.enable()}function Ze(){Q.allBodies(I.engine.world).forEach(B=>{(B.label==="mochi"||B.label==="orange"||B.label==="leaf")&&Q.remove(I.engine.world,B)}),Q.allConstraints(I.engine.world).forEach(B=>{Q.remove(I.engine.world,B)}),I.particles.forEach(B=>Q.remove(I.engine.world,B.body)),I.particles=[],document.querySelectorAll(".effect-text").forEach(B=>B.remove()),I.currentMochi=null,I.mochiState="none",Be()}function ue(){return I.stackedMochis.length>0?I.stackedMochis.reduce((B,P)=>P.position.y<B.position.y?P:B).position.y:I.baseTopY}function Ee(){if(I.state!=="playing")return;const{engine:D,width:B}=I,P=ue(),E=G.MOCHI_HEIGHT*G.DROP_MOCHI_COUNT,f=P-E,e=ee.rectangle(B/2,f,G.MOCHI_WIDTH,G.MOCHI_HEIGHT,{chamfer:{radius:G.MOCHI_HEIGHT*.5},isStatic:!1,friction:.9,frictionStatic:1,restitution:.01,density:.003,label:"mochi",render:{fillStyle:"#FFFFFF",strokeStyle:"#C8C0B0",lineWidth:3}});Q.add(D.world,e),I.currentMochi=e,I.mochiState="moving",I.moveX=B/2;const l=Math.min(G.MOVE_SPEED+I.score*.2,12);I.moveDir=Math.random()<.5?1:-1,I.currentSpeed=l,De(),_.playSpawn()}function Je(){if(I.mochiState!=="moving"||!I.currentMochi)return;const D=I.currentMochi;I.mochiState="dropping",ie.setVelocity(D,{x:0,y:5}),_.playDrop()}function qe(D){if(I.state==="playing")for(const B of D.pairs){const P=[B.bodyA,B.bodyB],E=I.currentMochi;if(!E||I.mochiState!=="dropping")continue;const f=P.includes(E),e=P.find(l=>l.label==="base"||l.label==="mochi"&&l!==E&&I.stackedMochis.includes(l));if(f&&e){_e(E);return}}}function _e(D){if(I.mochiState!=="dropping")return;I.mochiState="settling";let B=null;const P=100,E=()=>{if(I.state!=="playing")return;const f=D.velocity,e=Math.sqrt(f.x*f.x+f.y*f.y),l=Math.abs(D.angularVelocity);if(!(e<=.3&&l<=.02)){if(D.position.y>I.baseBottomY+20){fe();return}B=null,setTimeout(E,50);return}if(B===null&&(B=Date.now()),Date.now()-B<P){setTimeout(E,50);return}const o=Math.abs(D.position.x-I.width/2),u=G.PLAY_AREA_WIDTH/2-G.MOCHI_WIDTH/2+20;if(o>u||D.position.y>I.baseBottomY+20){fe();return}ie.setStatic(D,!0),I.score++,o<10?(I.combo++,I.maxCombo=Math.max(I.maxCombo,I.combo),I.perfectCount++,we(D.position.x,D.position.y-40,`PERFECT!! x${I.combo}`),nt(D.position.x,D.position.y+G.MOCHI_HEIGHT/2,10+I.combo*2),I.shake=10+Math.min(I.combo,10),_.playPerfect()):o<30?(I.combo=0,we(D.position.x,D.position.y-40,"GREAT!"),I.shake=5,_.playGood()):(I.combo=0,I.shake=2,_.playLand()),document.getElementById("score").textContent=I.score,I.stackedMochis.push(D),I.mochiState="none",I.currentMochi=null,Re(),Ee()};setTimeout(E,100)}function et(){for(const D of I.stackedMochis)if(D.position.y>I.baseBottomY+50)return!0;return!!(I.currentMochi&&I.mochiState==="dropping"&&I.currentMochi.position.y>I.baseBottomY+100)}function De(){const D=ue(),B=G.MOCHI_HEIGHT*G.DROP_MOCHI_COUNT,P=G.MOCHI_HEIGHT*5,E=D-B-P;E<0?I.cameraY=E:I.cameraY=0}function tt(){const{render:D,width:B,height:P,cameraY:E}=I,f=(Math.random()-.5)*I.shake,e=(Math.random()-.5)*I.shake;ne.lookAt(D,{min:{x:f,y:E+e},max:{x:B+f,y:P+E+e}})}function we(D,B,P){const E=document.createElement("div");E.className="effect-text",E.textContent=P;const f=I.canvas.getBoundingClientRect(),e=B-I.cameraY;E.style.left=f.left+D+"px",E.style.top=f.top+e+"px",document.body.appendChild(E),setTimeout(()=>E.remove(),1e3)}function nt(D,B,P){for(let E=0;E<P;E++){const f=ee.circle(D,B,Math.random()*4+2,{render:{fillStyle:"#C0A062"},frictionAir:.05,isSensor:!0,label:"particle"});ie.setVelocity(f,{x:(Math.random()-.5)*10,y:(Math.random()-1)*10}),Q.add(I.engine.world,f),I.particles.push({body:f,life:60})}}function fe(){I.state!=="gameover"&&(I.state="gameover",I.mochiState="none",ot(),at(),setTimeout(()=>{_.playGameOver();const D=Qe(I.score,I.maxCombo);Ae(D.highScore),document.getElementById("game-over-screen").classList.remove("hidden"),document.getElementById("final-score-small").textContent=I.score,document.getElementById("max-combo").textContent=I.maxCombo,document.getElementById("perfect-count").textContent=I.perfectCount;const B=[...q].reverse().find(P=>P.threshold<=I.score)||q[0];document.getElementById("rank-emoji").textContent=B.emoji,document.getElementById("rank-name").textContent=B.name,document.getElementById("rank-desc").textContent=B.desc,I.score>=10&&it()},1500))}function Re(){const D=[...q].reverse().find(B=>B.threshold<=I.score)||q[0];document.getElementById("comparison-text").textContent=`${D.emoji} ${D.name}`}function it(){const D=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722"];for(let B=0;B<50;B++){const P=document.createElement("div");P.className="confetti",P.style.left=Math.random()*100+"vw",P.style.backgroundColor=D[Math.floor(Math.random()*D.length)],P.style.animationDuration=Math.random()*2+2+"s",P.style.animationDelay=Math.random()*1+"s",document.body.appendChild(P),setTimeout(()=>P.remove(),4e3)}}function at(){const{render:D,width:B,height:P,stackedMochis:E,baseBottomY:f}=I;let e=I.baseTopY;E.length>0&&(e=E.reduce((v,r)=>r.position.y<v.position.y?r:v).position.y-100);const l=f+50,s=l-e,o=P,u=B;if(s>o){const n=o/s,v=(e+l)/2,r=B/2,t=u/n,a=o/n;ne.lookAt(D,{min:{x:r-t/2,y:v-a/2},max:{x:r+t/2,y:v+a/2}})}else ne.lookAt(D,{min:{x:0,y:e},max:{x:B,y:l}})}function ot(){const{engine:D,width:B,height:P,stackedMochis:E}=I,f=E.length>0?E.reduce((n,v)=>v.position.y<n.position.y?v:n):null,e=f?f.position.x:B/2,l=f?f.position.y-150:P-250,s=ee.circle(e,l,24,{label:"orange",render:{fillStyle:"#ff9800",strokeStyle:"#e65100",lineWidth:2}}),o=ee.circle(e,l-30,8,{label:"leaf",isSensor:!0,render:{fillStyle:"#4caf50"}});Q.add(D.world,[s,o]);const u=Me.Constraint.create({bodyA:s,pointA:{x:0,y:-20},bodyB:o,stiffness:.1,render:{visible:!1}});Q.add(D.world,u)}function rt(){const B=`é¤…ã‚’ç©ã‚“ã§ã€${([...q].reverse().find(f=>f.threshold<=I.score)||q[0]).name}ã€‘(${I.score}æ®µ)ã«ãªã£ãŸã‚ˆï¼ #é¤…ç©`,P=window.location.href,E=`https://twitter.com/intent/tweet?text=${encodeURIComponent(B)}&url=${encodeURIComponent(P)}`;window.open(E,"_blank")}function Fe(){st(),requestAnimationFrame(Fe)}function st(){if(I.state!=="playing")return;if(Pe.update(I.score,I.cameraY,I.width,I.height),et()){fe();return}const D=I.currentMochi;I.shake>0&&(I.shake*=.9,I.shake<.5&&(I.shake=0));for(let B=I.particles.length-1;B>=0;B--){const P=I.particles[B];P.life--,P.body.render.opacity=P.life/60,P.life<=0&&(Q.remove(I.engine.world,P.body),I.particles.splice(B,1))}if(D){if(I.mochiState==="moving"){ie.setVelocity(D,{x:0,y:0}),I.moveX+=I.currentSpeed*I.moveDir;const B=(I.width-G.PLAY_AREA_WIDTH)/2,P=B+G.PLAY_AREA_WIDTH,E=G.MOCHI_WIDTH/2+20;I.moveX>P-E?(I.moveX=P-E,I.moveDir=-1):I.moveX<B+E&&(I.moveX=B+E,I.moveDir=1);const f=ue(),e=G.MOCHI_HEIGHT*G.DROP_MOCHI_COUNT,l=f-e;ie.setPosition(D,{x:I.moveX,y:l})}De(),tt()}}window.addEventListener("DOMContentLoaded",Xe);
